# ๐ ุงูุฌูุณุฉ 4: ุงุฎุชุจุงุฑ ุขููุงุช ุงูููู ุงูุถุนููุฉ (CAPTCHA Bypass) + ุชุฌุงูุฒ ูุฎุทุท ุงููุตุงุฏูุฉ (Auth Schema Bypass)
## Slides 46 โ 61

---

## Slide 46: ุนููุงู ุงููุณู - Testing for Weak Lockout Mechanism: Bypassing CAPTCHA
### Authentication Testing

ูุฏุฎู ูู ููุถูุน ููุชุน ุฌุฏุงู ูู ุงูุฌุฒุก ุฏุง.

ูุญุฏ ุฏูููุชู ุงุชููููุง ุนู ุฅุฒุงู ูุฎุชุจุฑ ุงูู Username Enumeration ูุงูู Password Policy. ุจุณ ููู ุณุคุงู ููู: **ูู ุงููููุน ุญุงุทุท CAPTCHA ุฃู ุขููุฉ ููู ุนุดุงู ูููุนูู ุฃุนูู Brute Force - ูู ุฏู ูุนูุงู ุฅูู ูููุชุ** 

ุงูุฅุฌุงุจุฉ: **ูุฃ ุทุจุนุงู!** 

ูุชูุฑ ูู ุงูููุงูุน ุจุชุญุท CAPTCHA ูุฃููุง "ุฏูููุฑ" ุ ุจุณ ูู ุงูุญูููุฉ ุงูุชูููุฐ (Implementation) ุจุชุงุนูุง ูููู ุถุนูู ููููู ูุชุฎุทุงู ุจุณูููุฉ. ุงูุฌุฒุก ุฏุง ููุชุนูู ููู ุงุฒุงู ูุชุฎุทุงูุง .

---

## Slide 47: ุงูุชุนุฑูู ูุงูุฃูููุฉ
### Testing for Weak Lockout Mechanisms (WSTG-ATHN-03)

### ุงูุชุนุฑูู:
> ุงูุงุฎุชุจุงุฑ ุฏู ุจูุฑูุฒ ุนูู ุชูููู ูู **ุขููุงุช ุงูููู** (Lockout Mechanisms) ูู ุงูุชุทุจูู - ุฒู ุงูู CAPTCHA - **ุจุชููุน ูุนูุงู** ุงููุญุงููุงุช ุงูุขููุฉ ูุชุณุฌูู ุงูุฏุฎูู ุจุนุฏ ูุดู ูุญุงููุงุช ูุชูุฑ ููุง ูุฃ.

### ูุซุงู ูุฏู:
ุชุฎูู ุฅูู ุจุชุญุงูู ุชุฏุฎู ุดูุฉ ูุนูุฏู 100 ููุชุงุญ. ุตุงุญุจ ุงูุดูุฉ ุญุท ูุงููุฑุง ุนูู ุงูุจุงุจ ุนุดุงู ูู ุดุงูู ุจุชุฌุฑุจ ููุงุชูุญ ูุชูุฑ ูููู ุงูุจุงุจ.
**ุงูู CAPTCHA** ูู ุงููุงููุฑุง ุฏู - ุจุชุญุงูู ุชูุฑู ุจูู ุงูุฅูุณุงู ุงููู ุจูุฏุฎู ุจุงุณูุฑุฏู ุงูุนุงุฏู ูุจูู ุงูู Bot ุงููู ุจูุฌุฑุจ ููุงููู ุงูุจุงุณูุฑุฏุงุช!

### ููู ุฏู ุฎุทูุฑุ
ูู ุงูู CAPTCHA ุถุนููุฉ ุฃู ูุนูููุฉ ุบูุท:
- **ุงูููุงุฌู ูููุฏุฑ ูุนูู Brute Force ุจุฏูู ุนุงุฆู** โ ูุฏุฎู ุฃู ุญุณุงุจ
- **ูููุฏุฑ ูุนูู Credential Stuffing** โ ูุฌุฑุจ ููุงููู ุงูุจุงุณูุฑุฏุงุช ุงููุณุฑุจุฉ
- **ูููุฏุฑ ูุนูู Account Takeover ุนูู ุงูููุชุงุช ุงูุงุฏููุฒ** โ ุงูููู ุซุบุฑุฉ ูู ุงูููุน ุฏุง

> **๐ด ูู ูุงูุน ุงูู Pentesting:** ูู ุจุฑูุฌุฑุงู ุญููููุ ูููุช ูููุน ุจููู ุญุงุทุท CAPTCHA ุนูู ุตูุญุฉ ุงูู Login. ุจุณ ุงูู CAPTCHA ูุงูุช ุจุชุธูุฑ ุจุนุฏ **5 ูุญุงููุงุช ูุงุดูุฉ** ููุท. ุงููุดููุฉ ุฅู ุงูุนุฏุงุฏ ูุงู ูุฑุจูุท ุจุงูู **Session Cookie** ูุด ุจุงูู IP ุฃู ุงูุญุณุงุจ! ูุนูู ูู ูุง ุฃุนูู Delete ููู Cookie ูุฃุนูู Request ุฌุฏูุฏุ ุงูุนุฏุงุฏ ุจูุฑุฌุน ุตูุฑ ูุฏุฑุช ุฃุนูู Brute Force ุนูู ุฃู ุญุณุงุจ ุจุฏูู ูุง ุงูู CAPTCHA ุชุธูุฑูู ุฃุตูุงู

---

## Slide 48: ุชุนุฑูู ุงูู CAPTCHA ููุฏู ุงูุงุฎุชุจุงุฑ
### Testing for Weak Lockout Mechanisms: CAPTCHA

### ุฅูู ูู ุงูู CAPTCHAุ
> **CAPTCHA** = **C**ompletely **A**utomated **P**ublic **T**uring test to tell **C**omputers and **H**umans **A**part

ูุนูู ุญุฑููุงู: "ุงุฎุชุจุงุฑ ุชูุฑููุฌ ุนุงู ุขูู ุจุงููุงูู ููุชูููุฒ ุจูู ุงูุญุงุณูุจ ูุงูุฅูุณุงู" ููุง ุงููู ุดููุช ุญุงุฌุฉ ุชุนุงูู ูููู

ุงูููุฑุฉ ุจุจุณุงุทุฉ: **ุฅูู ุชุณุฃู ุงููุณุชุฎุฏู ุณุคุงู ุฃู ุชุฏููู ูููุฉ ุงูุฅูุณุงู ููุฏุฑ ูุญููุง ุจุณูููุฉ ุจุณ ุงูููุจููุชุฑ ูุด ููุนุฑู** (ูุธุฑูุงู!) ูุญุฏ ูู ูุฑูุจ ูุนูู. 

**ุฃูุซูุฉ:**
- "ุงูุชุจ ุงูุญุฑูู ุงููู ูู ุงูุตูุฑุฉ" 
- "ุงุฎุชุงุฑ ูู ุงูุตูุฑ ุงููู ูููุง ุฅุดุงุฑุฉ ูุฑูุฑ" 
- "ูุงู ูุงุชุฌ 3 + 7ุ" 
- ูุฑุจุน "ุฃูุง ูุด ุฑูุจูุช"

### ูุฏู ุงูุงุฎุชุจุงุฑ (Testing Objective):
> ุชูููู ูู ุงูู CAPTCHA ุฃู ุขููุงุช ุงูููู ุงูุชุงููุฉ ูููู **ูุชู ุชุฎุทููุง** ุนุดุงู ููุฏุฑ ุงูููุงุฌู ูููู ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู ุงูุขููุฉ (Brute Force ุฃู Dictionary Attack).

### ุฅูู ุงููู ุจูุฏูุฑ ุนููู ูู Pentesters:
1. ูู ุงูู CAPTCHA ุจูุชุดู ุนูููุง ุงูู **Server-Side** ููุง ุงูู **Client-Side** ุจุณุ
2. ูู ูููู **ููุณุญ ุงูู CAPTCHA Parameter** ูู ุงูู Request ููู ููุชูุจูุ
3. ูู ุงูู CAPTCHA Token ูููู **ูุชุนุงุฏ ุงุณุชุฎุฏุงูู** (Replay)? ---> ูุจูุงุด ูุดููุฑ ุงูู ุงูููุถูุน ุฏุง
4. ูู ุญู ุงูู CAPTCHA ูููู **ููุงููู ูู ุงูู Source Code**ุ
5. ูู ููู **Rate Limiting** ุฅุถุงูู ููุง ุจูุนุชูุฏ ุนูู ุงูู CAPTCHA ุจุณุ

> **๐ก ูุงุนุฏุฉ ุฐูุจูุฉ:** ุงูู CAPTCHA ุงูููุฑูุถ ุชููู **ุทุจูุฉ ุญูุงูุฉ ุฅุถุงููุฉ** (Defense in Depth) ูุด ุงูุญูุงูุฉ ุงููุญูุฏุฉ. ุงููููุน ูุงุฒู ูููู ุนูุฏู ููุงู Rate Limiting ู Account Lockout ุจุฌุงูุจ ุงูู CAPTCHA ูุฏู tip ูู ุงูุดูุงุฏุฉ ูููู ูู ุฌูุช ุทุจูุชูุง ูู ุงุฑุถ ุงููุงูุน ูุชูุจุณ info ู ููููู ุฏู best practice.

---

## Slide 49: ููุฏูุฉ ุนู ุฃููุงุน ุงูู CAPTCHAs
### Types of CAPTCHAs - Introduction

**ูุด ูู ุงูู CAPTCHAs ูุชุณุงููุฉ ูู ุงูููุฉ**. ููู ุฃููุงุน ุถุนููุฉ ุณูู ูุณุฑูุง ูููู ุฃููุงุน ูููุฉ.

ููุดูููู ุจุงูุชุฑุชูุจ ูู ุงูุฃุถุนู ููุฃููู:

```
 ุชุฑุชูุจ ููุฉ ุงูู CAPTCHAs:

๐ด ุถุนูู โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ููู๐ข

Arithmetic    Text-based    Image-based    reCAPTCHA v2    reCAPTCHA v3
  (ุญุณุงุจ)      (ูุต ูุดูู)      (ุตูุฑ)         (ูุฑุจุน)          (ุฎูู)
```

> **๐ก ูุนูููุฉ ูููุฉ:** ุญุชู ุฃููู CAPTCHA ูููู ุชุชูุณุฑ! ุงููุฑู ุจุณ ูู **ุงูุชูููุฉ ูุงููุฌููุฏ**. CAPTCHA ุถุนููุฉ ูููู ุชุชูุณุฑ ุจุณูุฑูุจุช ูุฌุงููุ ุจุณ reCAPTCHA v3 ูููู ูุญุชุงุฌ ุฎุฏูุฉ ุญู ูุฏููุนุฉ

---

## Slide 50: ุงูููุน ุงูุฃูู - Arithmetic-based CAPTCHA (ุถุนูู)
### 1. Arithmetic-based CAPTCHA (Weak)

### ุงูุดูู:
ุจุชุธูุฑูู ูุณุฃูุฉ ุญุณุงุจูุฉ ุจุณูุทุฉ ุฒู:
```
"What is 3 + 7?"
"Solve: 12 - 5 = ?"
"ูุงู ูุงุชุฌ 8 ร 2ุ"
```

### ููู ุถุนููุฉ ุฌุฏุงู (Weak)ุ 

**ุฃููุงู: ุงูููุจููุชุฑ ุฃุณุฑุน ูู ุงูุญุณุงุจ ูู ุงูุฅูุณุงู**
ุฏู ุฃุตูุงู ุนูุณ ููุฑุฉ ุงูู CAPTCHA - ุงูููุฑูุถ ุชุณุฃู ุณุคุงู ุงูุฅูุณุงู ููุฏุฑ ูุฌุงูุจู ูุงูููุจููุชุฑ ูุฃ. ุจุณ ุงูุญุณุงุจ ุงูููุจููุชุฑ ุจูุนููู ูู ูุญุธุชูุง

**ุซุงููุงู: ุนุฏุฏ ุงูุงุญุชูุงูุงุช ูุญุฏูุฏ:**
- ูู ุงููุณุฃูุฉ ูุชูุฌุชูุง ุจูู 0 ู 100 โ 100 ุงุญุชูุงู ููุท!
- ูู ุงููุณุฃูุฉ ุฌูุน ุฑูููู ุฃูู ูู 20 โ ุฃูู ูู 40 ุงุญุชูุงู!
- ููุฏุฑ ูุนูู Brute Force ุนูู ุงูุฅุฌุงุจุงุช ุจุณูููุฉ

**ุซุงูุซุงู: ูููู ุชุชูุฑุฃ ูู ุงูู HTML:**
ูุชูุฑ ูู ุงูููุงูุน ุจุชุญุท ุงููุณุฃูุฉ ูู ุงูู HTML ููุต ุนุงุฏู:
```html
<label>What is 3 + 7?</label>
<input type="text" name="captcha_answer">
```
ุณูุฑูุจุช ุจุณูุท ููุฏุฑ ููุฑุฃ ุงููุต ููุญุณุจู ููุฏุฎู ุงูุฅุฌุงุจุฉ!

### ุทุฑู ุงูุชุฎุทู:

```python
# ุณูุฑูุจุช ุจุณูุท ูู Python ูุญู Arithmetic CAPTCHA
import re

captcha_text = "What is 3 + 7?"
# ุฏุง ุนุดุงู ูุณุญุจ ุงูุฏุงุชุง ูู ุงูhtml
numbers = re.findall(r'\d+', captcha_text)
if '+' in captcha_text:
    answer = int(numbers[0]) + int(numbers[1])  # 10
elif '-' in captcha_text:
    answer = int(numbers[0]) - int(numbers[1])
```

> **๐ด ูู ูุงูุน ุงูู Pentesting:** ูู ูููุน ุญูููู ููุช ุจุฎุชุจุฑูุ ูุงูุช ุงูู CAPTCHA ุจุชููู "ุงูุชุจ ูุงุชุฌ X + Y". ุงููุณุฃูุฉ ูุงูุช ููุฌูุฏุฉ ููุต ูู ุงูู HTML ูููุงู ุงูุฅุฌุงุจุฉ ูุงูุช ููุฌูุฏุฉ ูู **Hidden Field** ูุนูู ุงูุฅุฌุงุจุฉ ููุชูุจุฉ ูู ุงูุณูุฑุณ ููุฏ:
> ```html
> <input type="hidden" name="captcha_solution" value="10">
> <label>What is 3 + 7?</label>
> ```
> ุงูุทุจูุนู ุงู ุงููุงุณ ุจุชูุฑุญ ููุง ุชูุงูู ุซุบุฑุฉ ุงูุง ููุชูุง ููุช ูุงุนุฏ ุจุถุญู ุฒู ุงููุฌููู

---

## Slide 51: ุงูููุน ุงูุชุงูู - Text-based CAPTCHA 
### 2. Text-based CAPTCHA (Basic)

### ุงูุดูู:
ุจุชุธูุฑูู ุตูุฑุฉ ูููุง ุญุฑูู ูุฃุฑูุงู **ูุดููุฉ** (Distorted) ุฃู ุนูููุง **ุชุดููุด** (Noise) ูุงููุทููุจ ุชูุชุจูุง.

ูุซุงู:
```
ุงูุตูุฑุฉ ูููุง: "X7kP2m"
ุงููุทููุจ: ุงูุชุจ "X7kP2m" ูู ุงููุฑุจุน
```

### ูุณุชูู ุงูุญูุงูุฉ: ููุฏุฑ ูููู ุงูู ูู ุงููุชูุณุท

**ุฒูุงู** (ูุจู 2015 ุชูุฑูุจุงู): ูุงูุช ูุนุงูุฉ ุฌุฏุงู ูุฃู ุชูููุงุช ูุฑุงุกุฉ ุงููุตูุต (OCR) ูุงูุช ุถุนููุฉ.

**ุฏูููุชู**: ุฃุตุจุญุช ุถุนููุฉ ุจุณุจุจ ุชุทูุฑ ุชูููุงุช ุงูู OCR ูุงูู Machine Learning.

### ููุงุท ุงูุถุนู:

**1. OCR (Optical Character Recognition):**
ุฃุฏูุงุช ุฒู **Tesseract** (ูุฌุงููุฉ ูููุชูุญุฉ ุงููุตุฏุฑ) ุจูุช ุดุงุทุฑุฉ ุฌุฏุงู ูู ูุฑุงุกุฉ ุงููุตูุต ุงููุดููุฉ:
```bash
# ุงุณุชุฎุฏุงู Tesseract ููุฑุงุกุฉ CAPTCHA
tesseract captcha_image.png output_text
cat output_text.txt
# ุงููุชูุฌุฉ: X7kP2m
```

**2. Machine Learning Models:**
ูููู ุชุฏุฑุจ ูููุฐุฌ AI ุนูู ุขูุงู ุงูุฃูุซูุฉ ูู ููุณ ููุน ุงูู CAPTCHA ูููุชุนูู ููุฑุฃูุง ุจุฏูุฉ ุนุงููุฉ (90%+).

**3. ุฎุฏูุงุช ุญู CAPTCHA ุงูุจุดุฑูุฉ:**
- **2Captcha**: ุจุชุจุนุชููู ุงูุตูุฑุฉ ููุงุณ ุญููููุฉ ุจุชุญููุง - ุงูุชูููุฉ ุญูุงูู $1 ููู 1000 CAPTCHA
- **Anti-Captcha**: ููุณ ุงูููุฑุฉ ุจุฃุณุนุงุฑ ูุดุงุจูุฉ
- **DeathByCaptcha**: ุฎุฏูุฉ ุชุงููุฉ ูุดุงุจูุฉ

```python
# ูุซุงู: ุงุณุชุฎุฏุงู ุฎุฏูุฉ 2Captcha ูุน Python
import requests

# ุจุชุจุนุช ุงูุตูุฑุฉ ููุฎุฏูุฉ
response = requests.post("http://2captcha.com/in.php", data={
    "key": "YOUR_API_KEY",
    "method": "base64",
    "body": base64_encoded_image
})
captcha_id = response.text.split("|")[1]

# ุจุชุณุชูู ุงูุญู (ุนุงุฏุฉู 10-30 ุซุงููุฉ)
import time
time.sleep(15)

# ุจุชุฌูุจ ุงูุญู
result = requests.get(f"http://2captcha.com/res.php?key=YOUR_API_KEY&action=get&id={captcha_id}")
captcha_answer = result.text.split("|")[1]
# ุงููุชูุฌุฉ: "X7kP2m"
```

> **๐ก ูุนูููุฉ:** ุญุชู ูู ุงูุชุดููู ููู (Background Noise, Overlapping Characters)ุ ุงูุจูุชุงุช ุงูุญุฏูุซุฉ ุจูุช ุจุชุชุนุงูู ูุนุงู. ุนุดุงู ูุฏู ูุนุธู ุงูููุงูุน ุงููุจูุฑุฉ ูุฌุฑุช ุงูู Text-based CAPTCHA.

---

## Slide 52: ุงูููุน ุงูุชุงูุช - Image-based CAPTCHA (ูุชูุณุท)
### 3. Image-based CAPTCHA (Moderate)

### ุงูุดูู:
ุจุชุธูุฑูู ูุฌููุนุฉ ุตูุฑ ูุจุชุทูุจ ููู ุชุฎุชุงุฑ ุงูุตูุฑ ุงููู ูููุง ุดูุก ูุนูู:
- "Select all images with **traffic lights**" 
- "Click on all images containing **crosswalks**" 
- "Select all squares with **bicycles**" 

### ูุณุชูู ุงูุญูุงูุฉ: ูุชูุณุท (Moderate) 

**ุฃุตุนุจ ูู ุงูู Text-based** ูุฃู:
- ุงูุชุนุฑู ุนูู ุงูุฃุดูุงุก ูู ุงูุตูุฑ ุฃุตุนุจ ุนูู ุงูููุจููุชุฑ ูู ูุฑุงุกุฉ ูุต
- ุงูุตูุฑ ุจุชุชุบูุฑ ูู ูุฑุฉ
- ูููู ูููู ููู ุฃุฌุฒุงุก ุบุงูุถุฉ ูุซูุงู: ูู ุงูุฅุดุงุฑุฉ ุงููู ูู ุฑูู ุงูุตูุฑุฉ ุชุนุชุจุฑ ุฅุดุงุฑุฉ ูุฑูุฑ ููุง ูุฃุ ุงุญูุง ูุจุดุฑ ุณุงุนุงุช ุจูุชูุฎุจุท ูููุง ููุชูุฑ 

### ููุงุท ุงูุถุนู:

**1. ุฎุฏูุงุช ุญู ูุฏููุนุฉ:**
ููุณ ุฎุฏูุงุช ุงูู 2Captcha ูAnti-Captcha ุจุชุญู Image CAPTCHAs ููุงูุ ุจุณ ุจุณุนุฑ ุฃุนูู (ุญูุงูู $2-4 ููู 1000).

**2. ููุงุฐุฌ AI ูุชูุฏูุฉ:**
- ุงูููุงุฐุฌ ุฒู **YOLO** ู **ResNet** ู **Google Vision API** ุจูุช ุดุงุทุฑุฉ ุฌุฏุงู ูู ุงูุชุนุฑู ุนูู ุงูุฃุดูุงุก ูู ุงูุตูุฑ
- ูููู ุชุฏุฑุจ ูููุฐุฌ ุนูู ููุน ุงูุตูุฑ ุงููุนูู ุงููู ุงูู CAPTCHA ุจุชุณุชุฎุฏูู

**3. Click Farms (ูุฒุงุฑุน ุงูููุฑ):**
ูุงุณ ูุนููุฉ (ุบุงูุจุงู ูู ุฏูู ุจุชูููุฉ ุนูุงูุฉ ููุฎูุถุฉ) ุจููุนุฏูุง ูุญููุง CAPTCHAs ุทูู ุงูููู. ุงูููุงุฌู ุจูุจุนุชููู ุงูู Challenge ูููุง ูุญููู ูู ุซูุงูู!

> **๐ด ุญูุงุฑ ุญูููู:** ููู ุดุฑูุงุช ูุงููุฉ ูู ุฏูู ุฒู ุงูููุฏ ูููุชูุงู ูุจูุฌูุงุฏูุด ูุชุฎุตุตุฉ ูู ุญู CAPTCHAs ุจุงูุจุดุฑ. ุงูููุธู ุงููุงุญุฏ ุจูุญู ุญูุงูู 500-1000 CAPTCHA ูู ุงูุณุงุนุฉ! ูุนูู ูุตูุน ูุญู 50,000 CAPTCHA ูู ุงูุณุงุนุฉ!

---

## Slide 53: ุงูููุน ุงูุฑุงุจุน - reCAPTCHA v2 & v3 (ููู)
### reCAPTCHA v2 (Moderate to Strong) & reCAPTCHA v3 (Very Strong)

### reCAPTCHA v2 - "I'm not a robot" 

**ุฅุฒุงู ุจูุดุชุบู:**
ูุด ูุฌุฑุฏ ูุฑุจุน ุจุชุถุบุท ุนููู! ูุฑุงู ุชุญููู ูุนูุฏ:

1. **ุจูุญูู ุญุฑูุฉ ุงููุงูุณ ุจุชุงุนุชู** - ุงูุฅูุณุงู ุจูุญุฑู ุงููุงูุณ ุจุดูู ุนุดูุงุฆู ูุทุจูุนูุ ุจุณ ุงูุจูุช ุจูุฑูุญ ุนูู ุงููุฑุจุน ุจุฎุท ูุณุชููู
2. **ุจูุดูู ุงูู Cookies** ุจุชุงุนุชู - ูู ุนูุฏู Google Account ูุณุฌู ุฏุฎูู ููู ูุจุชุณุชุฎุฏู ุงูุฅูุชุฑูุช ุนุงุฏูุ ุฏู ุจูุฑูุน ุซูุชู ุฅูู ุฅูุณุงู
3. **ุจูุญูู ุงูู Browser Fingerprint** - ุฅุตุฏุงุฑ ุงููุชุตูุญุ ุญุฌู ุงูุดุงุดุฉุ ุงูู Plugins ุงููุซุจุชุฉ
4. **ุจูุดูู ุณูููู ุนูู ุงูุตูุญุฉ** - ุฅูุช ูุนุฏุช ูุฏ ุฅููุ ุชุตูุญุช ุงูุตูุญุฉ ููุง ุฑุญุช ุนูู ุงููุฑุจุน ุนูู ุทููุ

**ูู ูุด ูุชุฃูุฏ ุฅูู ุฅูุณุงู** โ ุจูุฏูู Challenge ุฅุถุงูู (ุฒู ุงุฎุชูุงุฑ ุตูุฑ).

**ูุณุชูู ุงูุญูุงูุฉ:** ูุชูุณุท ุฅูู ููู 

### reCAPTCHA v3 - ุงูู "Ghost CAPTCHA" ๐ป

ุฏู **ุซูุฑุฉ** ูู ุนุงูู ุงูู CAPTCHA ูููุด ุฃู ุชูุงุนู ูู ุงููุณุชุฎุฏู ุฎุงูุต!

**ุฅุฒุงู ุจูุดุชุบู:**
1. ุจูุดุชุบู ูู ุงูุฎูููุฉ (Background) ุจุฏูู ุฃู ุธููุฑ ูููุณุชุฎุฏู
2. ุจูุฑุงูุจ ุณููู ุงููุณุชุฎุฏู ุนูู ุงููููุน ููู (ูุด ุตูุญุฉ ูุงุญุฏุฉ ุจุณ)
3. ุจูุฏู **Score** ูู 0.0 ุฅูู 1.0:
   - **1.0** = ุฃูุช ุฅูุณุงู 100% 
   - **0.5** = ูุด ูุชุฃูุฏ 
   - **0.0** = ุฃูุช ุจูุช 100% 
4. ุตุงุญุจ ุงููููุน ุจูุญุฏุฏ ุงูู Threshold (ูุซูุงู: ูู ุงูู Score ุฃูู ูู 0.5 โ ุงุฑูุถ ุงูุทูุจ)

**ูุณุชูู ุงูุญูุงูุฉ:** ููู ุฌุฏุงู 

### ุฅุฒุงู ุจูุชุฎุทู reCAPTCHAุ

**ุงูุทุฑููุฉ 1: ุฎุฏูุงุช ุญู ุจุดุฑูุฉ ูุชุฎุตุตุฉ**
- **2Captcha** ู **Anti-Captcha** ุนูุฏูู API ุฎุงุต ูุญู reCAPTCHA
- ุจุชุจุนุชููู ุงูู Site Key ู URLุ ูููุง ุจููุชุญูุง ุงูุตูุญุฉ ููุญููุง ุงูู CAPTCHA ููุฑุฌุนููู ุงูู Token
- ุงูุชูููุฉ: $2-3 ููู 1000 reCAPTCHA v2

```python
# ุญู reCAPTCHA v2 ุนู ุทุฑูู 2Captcha
response = requests.post("http://2captcha.com/in.php", data={
    "key": "YOUR_API_KEY",
    "method": "userrecaptcha",
    "googlekey": "SITE_KEY_HERE",  # ูู ููุฏ ุงูุตูุญุฉ
    "pageurl": "https://target.com/login"
})
```

**ุงูุทุฑููุฉ 2: ูู reCAPTCHA v3 - ูุญุงูุงุฉ ุงูุณููู ุงูุจุดุฑู**
- ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุฒู **Puppeteer** ุฃู **Selenium** ูุน ููุชุจุงุช Anti-Detection
- ูุญุงูุงุฉ ุญุฑูุงุช ูุงูุณ ุทุจูุนูุฉ ูุชุตูุญ ุนุงุฏู

> **๐ด ููุทุฉ ูููุฉ ูู ุงูู Pentesting:** ูู ูุชูุฑ ูู ุงูุญุงูุงุชุ ูุด ูุญุชุงุฌ ุชูุณุฑ ุงูู CAPTCHA ููุณูุง! ูููู ุชูุงูู ุฅู:
> - ุงูู CAPTCHA Token ูุจูุชุญููุด ููู ุนูู ุงูุณูุฑูุฑ (Server-Side Validation ููููุฏ) ุฏุง ุจูุญุตู ููุง ูุจุฑูุฌ ููุณู ููุชุจ Middleware ูุชุดู ุนูู ุงูุชููู
> - ุงูู CAPTCHA ุจุชุธูุฑ ุจุณ ุนูู Interface ูุนูู ุจุณ ูููุด ุนูู ุงูู API ุจูุจูู ุฒู security layer ุนูู ุงููุฑููุช ุงูุฏ ุจุณ
> - ูููู ุชูุณุญ Parameter ุงูู CAPTCHA ูู ุงูู Request ูุงูุณูุฑูุฑ ููุจูู ุนุงุฏู ุฑูุฒ ุนูู ุงูุซุบุฑุงุช **ุงูููุทููุฉ** (Logic Flaws) ุงูุฃูู ุชุนุงูู ุงููููุงูู ูู ุงูุณุฑูุน

>**ุชูุถูุญ ููููุฑุฉ๐ด**
>
>- ููุฏ ุชูุถูุญู ููููุฑุฉ ูุด ุงูุชุฑ
>```
>app.post('/login', (req, res) => {
>    const { token } = req.body;
>
>    // ูู ุงูุชููู ุบูุท ุงุฑูุถ ุงูุทูุจ 
>    if (!token || !verifyCaptcha(token)) {
>        return res.status(403).send("Captcha Required!");
>    } 
>    performLogin(req.body);
>});
>```
> - ุทุจ ุงูุฑุฑุถ ูููุด ุชููู ูุจุนูุช ุงุตูุง ูุจุงูุชุงูู ูุด ููุฎุด ุนูู ุงูcondition ุฏุง ู ููุนุฏู ุนุงุฏู 
> 
---

##  Slide 54: Lab Demo - Testing for Weak Lockout Mechanism: Bypassing CAPTCHA
###  Lab Demo

ุงูุณูุงูุฏ ุฏู ุนุจุงุฑุฉ ุนู **Lab ุนููู** ูุชุทุจูู ูู ุงููู ุงุชุนูููุงู.

### ุงูุฎุทูุงุช ุงูุนูููุฉ ุงููู ุจุชุชุนูู ูู ุงูู Lab:

#### Step 1: ุงูุงุณุชุทูุงุน (Reconnaissance)
```
1. ุงูุชุญ ุตูุญุฉ ุงูู Login ูู ุงููุชุตูุญ
2. ุฌุฑุจ ุชุณุฌูู ุฏุฎูู ุจููุฒุฑ ูุจุงุณูุฑุฏ ุบูุท ุนุฏุฉ ูุฑุงุช
3. ูุงุญุธ:
   - ุจุนุฏ ูุงู ูุญุงููุฉ ุงูู CAPTCHA ุจุชุธูุฑ?
   - ุฅูู ููุน ุงูู CAPTCHA ุงููุณุชุฎุฏูุฉ?
   - ูู ููู ุขููุฉ Lockout ุชุงููุฉ ุบูุฑ ุงูู CAPTCHA?
```

#### Step 2: ุชุญููู ุงูู Request ูู Burp Suite
```http
POST /login HTTP/1.1
Host: target.com
Content-Type: application/x-www-form-urlencoded

username=admin&password=wrong&captcha=ABCD&captcha_token=xyz123
```

#### Step 3: ุชุฌุฑุจุฉ ุงูุทุฑู ุงููุฎุชููุฉ ููุชุฎุทู

**ุงูุทุฑููุฉ 1: ูุณุญ Parameter ุงูู CAPTCHA**
```http
# ุฌุฑุจ ุชุจุนุช ุงูู Request ูู ุบูุฑ ุงูู CAPTCHA ุฎุงูุต:
POST /login HTTP/1.1
username=admin&password=wrong
# ูู ุงุชูุจู โ CAPTCHA Validation ููููุฏ! Finding
```

**ุงูุทุฑููุฉ 2: ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูู Token**
```
1. ุญู ุงูู CAPTCHA ูุฑุฉ ูุงุญุฏุฉ
2. ุฎุฏ ุงูู captcha_token ุงููู ุทูุน
3. ุงุณุชุฎุฏู ููุณ ุงูู Token ูู 100 Request
4. ูู ูููู ุงุดุชุบููุง โ Token Replay Finding
```

**ุงูุทุฑููุฉ 3: ุงููููุฉ ุงููุงุฑุบุฉ**
```http
# ุฌุฑุจ ุชุจุนุช ุงูู CAPTCHA ูุงุถูุฉ:
username=admin&password=wrong&captcha=&captcha_token=
# ูู ุงุชูุจู โ Null Value Bypass
```

**ุงูุทุฑููุฉ 4: ูุญุต ุงูู Source Code**
```html
<!-- ุณุงุนุงุช ุงูุญู ุจูุจูู ูู ุงูู HTML  ููุณู ุฒู ูุง ุญููุช ุซุบุฑุฉ ุงููููุน ููู! -->
<div id="captcha" data-answer="42" style="display:none">
```

> **ูุตูุญุฉ ุฐูุจูุฉ:** ููุง ุชูุชุจ ูู ุชูุฑูุฑ ุงูู Pentestุ ูุถุญ ุฅู ุงูู CAPTCHA Bypass ุฏู ูุด ูุฌุฑุฏ ุซุบุฑุฉ ูุธุฑูุฉ. ููู ุฅูู:"
> ```
> "ุจุนุฏ ุชุฎุทู ุงูู CAPTCHAุ ูุฏุฑุช ุฃุนูู Brute Force ุนูู ุญุณุงุจ ุงูุฃุฏูู
> ูุงูุชุดูุช ุงูุจุงุณูุฑุฏ ูู X ุฏูููุฉ ุจุงุณุชุฎุฏุงู ููุณุช rockyou.txt"
> ```
> ุฏู ุจูุฎูู ุงูุชุฑูุงุฌุฑ ููุฏุฑ ุญุฌู ุงููุดููุฉ ุงูุญูููู ู ุฏุง ูุด ุจูุญุตู ุจุฑุถู 

---

## Slide 55: ุนููุงู ุงููุณู ุงูุฌุฏูุฏ - Bypassing Authentication Schema: Parameter Manipulation
### Authentication Testing

ุฏูููุชู ุจููุชูู ูููุถูุน **ุฃุฎุทุฑ ูุฃุนูู**: ูุด ุจุณ ููุชุฎุทู ุงูู CAPTCHA - ูุฃุ ููุชุฎุทู **ุงูู Authentication ููู!** 

ุงูู **Parameter Manipulation** ูุนูู ุฅูู ุจุชูุนุจ ูู ุงูููู ุงููู ุจุชุชุจุนุช ุจูู ุงููุชุตูุญ ูุงูุณูุฑูุฑ ุนุดุงู ุชุฎุฏุน ุงูุชุทุจูู ุฅูู ูุณุชุฎุฏู ูุตุฑุญ ููู.

---

## Slide 56: ุชุนุฑูู ุชุฌุงูุฒ ูุฎุทุท ุงููุตุงุฏูุฉ
### Bypassing Authentication Schema (WSTG-ATHN-04)

### ุงูุชุนุฑูู:
> ุงุฎุชุจุงุฑ **"ุชุฌุงูุฒ ูุฎุทุท ุงููุตุงุฏูุฉ"** ูู ุฏููู OWASP WSTG ุจูุฑูุฒ ุนูู **ุชุญุฏูุฏ ููุงุท ุงูุถุนู** ูู ุนูููุงุช ุงููุตุงุฏูุฉ ุงููู ุจุชุณูุญ ููููุงุฌููู ุฅููู **ูุชุฎุทูุง ุขููุงุช ุงููุตุงุฏูุฉ ุจุงููุงูู**. ุงูุงุฎุชุจุงุฑ ุฏู ุจูุณุงุนุฏ ุงูู Pentester ูููู ูู ููู ูุฌูุงุช ูู ูุฎุทุท ุงููุตุงุฏูุฉ ูููู ุชุฏู ูุตูู ุบูุฑ ูุตุฑุญ.

### ูุซุงู ูุฏู:
ุชุฎูู ุฅู ุงููููุน ุฏู ุนูุงุฑุฉ ุณูููุฉ:
- **ุงูุจุงุจ ุงูุฑุฆูุณู** ุนููู ุจูุงุจ ููุงููุฑุงุช ูุจุตูุฉ โ ุฏู ุงูู Login Page
- ุจุณ ููู **ุจุงุจ ุฎููู** ููุชูุญ ุนูู ุทูู โ ุฏู ุงูู Unprotected Endpoint
- ูููู **ุดุจุงู ูู ุงูุฏูุฑ ุงูุฃุฑุถู ููุณูุฑ** โ ุฏู ุงูู Parameter Manipulation
- ูููู **ููุชุงุญ ุงุญุชูุงุทู ุชุญุช ุงูุณุฌุงุฏุฉ** โ ุฏู ุงูู Default Credentials

ุฅุญูุง ูู Pentesters ุจูุฏูุฑ ุนูู ูู ุงูุทุฑู ุงูุจุฏููุฉ ุฏู ุนุดุงู ูุฏุฎู ูู ุบูุฑ ูุง ูุนุฏู ูู ุงูุจุงุจ ุงูุฑุฆูุณู

### ููู ุฏู ูู ุฃุฎุทุฑ ุงูุซุบุฑุงุชุ
ูุฃูู **ูุด ูุญุชุงุฌ ุฃู Credentials** (ููุฒุฑ ูุจุงุณูุฑุฏ) ุนุดุงู ุชุฏุฎู ูุด ุจุชุฎูู ุจุงุณูุฑุฏ ููุง ุจุชุนูู Brute Force - ุฃูุช ุญุฑููุงู **ุจุชุชุฌุงูุฒ ุงูู Login ููู**

> **๐ด ุชุตููู ุงูุฎุทูุฑุฉ:** ุซุบุฑุงุช ุชุฌุงูุฒ ุงูู Authentication ุฏุงููุงู ุจุชุชุตูู **Critical** (9.0-10.0 CVSS) ูุฃููุง ุจุชุฏู ูุตูู ูุงูู ุจุฏูู ุฃู ุจูุงูุงุช ุงุนุชูุงุฏ. ูู ุงูู Bug Bountyุ ุงูุซุบุฑุงุช ุฏู ุจุชุฌูุจ ููุงูุขุช ูุจูุฑุฉ **ุญุณุจ ุงูุดุฑูุฉ ูุนูู**

---

## Slide 57: ุฃูุฏุงู ุงูุงุฎุชุจุงุฑ ุจุงูุชูุตูู
### Bypassing Authentication Schema - Testing Goals

### ุงูุฃูุฏุงู ุงูุฑุฆูุณูุฉ:

#### 1๏ธโฃ Detect Misconfigurations (ุงูุชุดุงู ุฃุฎุทุงุก ุงูุฅุนุฏุงุฏ)
ุจูุฏูุฑ ุนูู ุฅุนุฏุงุฏุงุช ุบูุท ุฒู:
- ูููุงุช Configuration ููุดููุฉ (`.env`, `config.yml`, `web.config`)
- Debug Mode ููุชูุญ ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ (Production)
- Default Settings ูุด ูุชุบูุฑุฉ ุจุนุฏ ุงูุชุซุจูุช

```
# ุฃูุซูุฉ ููููุงุช ููุดููุฉ:
https://example.com/.env
https://example.com/config/database.yml
https://example.com/phpinfo.php
https://example.com/actuator/env    โ (Spring Boot)
```

#### 2๏ธโฃ Identify Alternative Routes (ุฅูุฌุงุฏ ุทุฑู ุจุฏููุฉ)
ุจูุฏูุฑ ุนูู ูุณุงุฑุงุช ุชุงููุฉ ููููุงุด ุญูุงูุฉ:
```
# ุงูุทุฑูู ุงูุนุงุฏู (ูุญูู):
/admin/login โ /admin/dashboard

# ุทุฑู ุจุฏููุฉ ูููู ุชููู ููุชูุญุฉ:
/admin/dashboard          โ ูุจุงุดุฑุฉ ุจุฏูู Login!
/api/v1/admin/users       โ API endpoint ููุดูู
/backup/admin.php         โ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุฏููุฉ
/admin/dashboard.bak      โ ูุณุฎุฉ ูุฏููุฉ ููุณูุฉ
```

#### 3๏ธโฃ Validate if Unprotected Endpoints Allow Access (ุงูุชุฃูุฏ ูู ุญูุงูุฉ ูู ุงูู Endpoints)
ุจูุชุฃูุฏ ุฅู **ูู** ุตูุญุฉ ููู API Endpoint ุนูููุง Authentication Check:

```
# ูุซุงู: ุฃุฏุงุฉ ffuf ูุงูุชุดุงู Endpoints ููุดููุฉ
ffuf -w /usr/share/wordlists/SecLists/Discovery/content-discovery/web-content/directory-list-2.3-medium.txt \
     -u https://target.com/admin/FUZZ \
     -fc 401,403
# ุงููุชูุฌุฉ: ุงูุตูุญุงุช ุงููู ุฑุฏุช ุจู 200 OK = ูููู ุชููู ููุดููุฉ
```
---

##  Slide 58: ุฃููุงุน ุงูุซุบุฑุงุช - ุงูููุน ุงูุฃูู
### 1. Unprotected Authentication Endpoints

### ุงูุชุนุฑูู:
> ุจุนุถ ุงูุชุทุจููุงุช ุจุชูุดู Endpoints ุฃู ููุงุฑุฏ **ูุด ูุญุชุงุฌุฉ Authentication**. ุงูููุงุฌู ููุฏุฑ ููุตููุง ูุจุงุดุฑุฉ ุจุฏูู ุชุณุฌูู ุฏุฎูู.

### ุฃูุซูุฉ ุดุงุฆุนุฉ:

**ุฃ) ููุญุฉ ุชุญูู ุงูุฃุฏูู ููุดููุฉ:**
```
https://example.com/admin/
https://example.com/administrator/
https://example.com/admin-panel/
https://example.com/wp-admin/              โ WordPress
https://example.com/manager/html           โ Tomcat
```

**ุจ) ูููุงุช Configuration ููุดููุฉ:**
```
https://example.com/.git/config            โ Git Repository
https://example.com/.env                   โ Environment Variables
https://example.com/config.php.bak         โ ูุณุฎุฉ ุงุญุชูุงุทูุฉ
https://example.com/phpinfo.php            โ ูุนูููุงุช ุงูุณูุฑูุฑ
https://example.com/server-status          โ Apache Status
https://example.com/elmah.axd              โ .NET Error Logs
```

**ุฌ) API Endpoints ุจุฏูู Authentication:**
```
https://example.com/api/users              โ ูุงุฆูุฉ ูู ุงููุณุชุฎุฏููู!
https://example.com/api/v1/admin/config    โ ุฅุนุฏุงุฏุงุช ุงูุฃุฏูู
https://example.com/graphql                โ GraphQL Introspection ููุชูุญ
```

> **๐ด ูุตุฉ ุญููููุฉ:** ูู 2019ุ ุจุงุญุซ ุฃููู ุงูุชุดู ุฅู ุดุฑูุฉ ูุงู ุนูุฏูุง **Elasticsearch** ููุดูู ุนูู ุงูุฅูุชุฑูุช ุจุฏูู ุฃู Authentication. ูุฏุฑ ููุตู ูู **275 ููููู ุณุฌู** ูููู ุฃุณูุงุก ูุฅููููุงุช ูุฃุฑูุงู ุชูููููุงุช! ุงูุดุฑูุฉ ูุงูุช ุงูุชูุฑุช ุฅู ูุฌุฑุฏ "ุนุฏู ูุดุฑ ุงูุฑุงุจุท" ูุงูู ูุญูุงูุฉ (Security by Obscurity).

---

##  Slide 59: ุฃููุงุน ุงูุซุบุฑุงุช - ุงูููุน ุงูุชุงูู ูุงูุชุงูุช
### 2. Default/Hardcoded Credentials & 3. Weak Access Controls

### 2๏ธโฃ Default or Hardcoded Credentials (ุจูุงูุงุช ุงุนุชูุงุฏ ุงูุชุฑุงุถูุฉ ุฃู ููุชูุจุฉ ูู ุงูููุฏ)

**ููู ุจููุงูููุงุ**

| ุงูููุงู | ูุซุงู |
|--------|------|
| **ููุฏ ุงูุชุทุจูู** | `if (password == "admin123")` |
| **ูููุงุช ุงูุฅุนุฏุงุฏ** | `DB_PASSWORD=root` ูู `.env` file |
| **ุฃูุธูุฉ CMS** | WordPress: `admin/admin`, Joomla: `admin/admin` |
| **ุฃุฌูุฒุฉ ุงูุดุจูุฉ** | Routers: `admin/password`, `admin/1234` |
| **ููุงุนุฏ ุจูุงูุงุช** | MongoDB: ูููุด ุจุงุณูุฑุฏ!, MySQL: `root/` (ูุงุฑุบ) |
| **GitHub Repos** | ุงููุจุฑูุฌ ูุณู ูุดูู ุงูุจุงุณูุฑุฏ ูุจู ูุง ูุฑูุน ุงูููุฏ |

**ุฃุฏูุงุช ูููุฏุฉ:**
```bash
# ุฃุฏุงุฉ ููุจุญุซ ุนู Default Credentials
# DefaultCreds-Cheat-Sheet
python3 creds.py --search "tomcat"
# ุงููุชูุฌุฉ: Username: tomcat, Password: tomcat

# ุงูุจุญุซ ูู GitHub ุนู Secrets ูุณุฑุจุฉ
# ุฃุฏุงุฉ truffleHog
trufflehog git https://github.com/target/repo
```

### 3๏ธโฃ Weak or Missing Access Controls (ุถุนู ุฃู ุบูุงุจ ุงูุชุญูู ูู ุงููุตูู)

**ุงููุดููุฉ:** ุจุนุถ ุงูุตูุญุงุช ุฃู ุงูููุงุฑุฏ ููููุงุด ุชุญูู ูุงูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู.

**ูุซุงู:**
```
# ููุณุชุฎุฏู ุนุงุฏู (role=user) ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู:
GET /api/users/123/profile    โ ุจูุดุชุบู (ุฏู ุญุณุงุจู)

# ุจูุบูุฑ ุงูุฑูู:
GET /api/users/1/profile      โ   (ุฏู ุญุณุงุจ ุงูุฃุฏูู)  ุจุณ ุงูุณููุงุฑูู ูุด ูุงูุนู ุดููุฉ

# ุฏู ุงุณูู IDOR - Insecure Direct Object Reference
```

> **ูุตูุญุฉ :** ุฃูู ูุง ุชุนูู Login ุจููุฒุฑ ุนุงุฏูุ ุฌุฑุจ ุชูุชุญ ูู ุงูู URLs ุงููู ุงูููุฑูุถ ููุฃุฏูู ุจุณ. ูุชูุฑ ูู ุงูููุงูุน ุจุชุนูู Authentication ุจุณ ูุจุชุนููุด Authorization - ูุนูู ุจุชุชุฃูุฏ ุฅูู ูุณุฌู ุฏุฎูู ุจุณ ูุจุชุชุฃูุฏุด ุฅู ุนูุฏู **ุตูุงุญูุฉ** ุชูุตู ููุตูุญุฉ ุฏู

---

## Slide 60: ุงูููุน ุงูุฎุงูุณ - Parameter Manipulation
### 5. Parameter Manipulation

ุฏู ุจูู **ุงูู Boss Level**  ูู ุงูุฌุฒุก ุฏุง

### ุงูุชุนุฑูู:
> ุงูููุงุฌู ุจูุชูุงุนุจ ูู **URL Parameters, Cookies, Headers, ุฃู POST Data** ุนุดุงู ูุฎุฏุน ุงูุชุทุจูู ููุชุฎุทู ุงูู Authentication.

### ุฃูุซูุฉ ุนูููุฉ ููุตูุฉ:

#### ุฃ) ุงูุชูุงุนุจ ุจุงูู URL Parameters:
```http
# ุงูุทูุจ ุงูุนุงุฏู:
GET /profile?user_id=101&role=user HTTP/1.1

# ุงูุชูุงุนุจ:
GET /profile?user_id=1&role=admin HTTP/1.1
# โ ุบูุฑูุง ุงูู user_id ูุฑูู 1 (ุนุงุฏุฉู ุงูุฃุฏูู)
# โ ูุบูุฑูุง ุงูู role ูู user ูู admin
```

#### ุจ) ุงูุชูุงุนุจ ุจุงูู Cookies:
```http
# Cookie ุนุงุฏูุฉ:
Cookie: session=abc123; role=user; isAdmin=false

# ุจุนุฏ ุงูุชูุงุนุจ (ุจุงุณุชุฎุฏุงู Burp ุฃู DevTools):
Cookie: session=abc123; role=admin; isAdmin=true
# ูู ุงูุชุทุจูู ุจูุนุชูุฏ ุนูู ููู ุงูู Cookie ููุชุญูู ูู ุงูุตูุงุญูุงุช โ Bypass!
```

#### ุฌ) ุงูุชูุงุนุจ ุจุงูู HTTP Headers:
```http
# ุจุนุถ ุงูุชุทุจููุงุช ุจุชุซู ูู Headers ูุนููุฉ:
GET /admin HTTP/1.1
X-Forwarded-For: 127.0.0.1
# โ ุจูููู ููุณูุฑูุฑ ุฅููุง ุฌุงููู ูู localhost!

# ุฃู:
GET /admin HTTP/1.1
X-Original-URL: /admin/dashboard
X-Rewrite-URL: /admin/dashboard
# โ ุจูุชุฌุงูุฒ ุงูู URL-based Access Control
```

#### ุฏ) ุงูุชูุงุนุจ ุจุงูู POST Data:
```http
POST /login HTTP/1.1
Content-Type: application/json

{
  "username": "admin",
  "password": "wrong",
  "authenticated": true,     โ !! ุจูุถูู Field ูุด ููุฌูุฏ
  "role": "administrator"    โ !! ุจูุถูู Field ูุด ููุฌูุฏ
}
```

**ููุงุญุธุฉ ูููุฉ ูู ุงูุณูุงูุฏ:** ุฏู ูุด ูุงุฆูุฉ ุดุงููุฉ ููู ุงูุซุบุฑุงุช ุงููู ุจูุฎุชุจุฑูุง - ููุณุชูุดู ุงูุจุงูู ูู ูุง ูุชูุฏู ูู ุงูููุฑุณ.

> **๐ด ูู ูุงูุน ุงูู Pentesting :** ูู ูุฑุฉ ููุช ุจุฌุฑุจ ุนูู Organization ูููุช ุฅู ุจุนุฏ ูุง ุชูุจู ุงูinvite ุฌูุง ุงูorganizationุ ุงูุจุฑูุฌุฑุงู ูุงู ุจูุญุท Cookie ุงุณููุง `user_type=user + user_id=42`. ุฌุฑุจุช ุฃุบูุฑูุง ูู `user_type=admin + user_id=1` - **ุฎูุงูู ุงูุงุฏูู ุจุชุงุน ุงูorganization**  ูุฏุฑุช ุจูู ุงุญุท ู ุงุดูู ูู ุงูุญุณุงุจุงุช ุงูู ููุฌูุฏุฉ ุงูุณุจุจ: ุงููุจุฑูุฌ ูุงู ุจูุนุชูุฏ ุนูู ุงูู Cookie ุนุดุงู ูุญุฏุฏ ููุน ุงููุณุชุฎุฏู ุจุฏู ูุง ูุฑุฌุน ููุงุนุฏุฉ ุงูุจูุงูุงุช
>


---

## Slide 61: Lab Demo - Bypassing Authentication Schema: Parameter Manipulation
###  Lab Demo

### ุฎุทูุงุช ุงูู Lab ุงูุชูุตูููุฉ:

#### Step 1: ุงุณุชุทูุงุน (Reconnaissance)
```
1. ุณุฌู ุฏุฎูู ุจุญุณุงุจ ุนุงุฏู (User)
2. ุชุตูุญ ูู ุงูุตูุญุงุช ูุณุฌู ุงูู URLs ูุงูู Parameters
3. ูุงุญุธ ุฃู Parameters ูุฑุชุจุทุฉ ุจุงูุตูุงุญูุงุช (role, admin, user_type, access_level)
```

#### Step 2: ุชุญููู ุงูู Requests ูู Burp Suite
```
1. ุดุบู Burp Suite ูุฎููู ูุนุชุฑุถ ุงูู Traffic
2. ุณุฌู ุฏุฎูู ูุชุตูุญ ุงููููุน
3. ุงูุชุญ HTTP History ูู Burp
4. ุงูุญุต ูู Request ูุฏูุฑ ุนูู:
   - Parameters ูู ุงูู URL
   - Parameters ูู ุงูู POST Body
   - Values ูู ุงูู Cookies
   - Headers ูุซูุฑุฉ ููุงูุชูุงู
```

#### Step 3: ุงูุชูุงุนุจ ูุงูุงุณุชุบูุงู
```
1. ุงุจุนุช ุงูู Request ููู Burp Repeater
2. ุบูุฑ ุงูููู ุงููุดุจููุฉ ูุงุญุฏุฉ ูุงุญุฏุฉ:
   - role=user โ role=admin
   - isAdmin=0 โ isAdmin=1
   - user_id=101 โ user_id=1
3. ุงุจุนุช ุงูู Request ุงููุนุฏู ูุดูู ุงูุฑุฏ
4. ูู ุงูุฑุฏ ูุฎุชูู (ูุซูุงู ูุชุญูู ุตูุญุฉ ุงูุฃุฏูู) โ Finding!
```

#### Step 4: ุงูุชูุซูู
```
1. ุฎุฏ Screenshot ููู Request ุงูุฃุตูู ูุงููุนุฏู
2. ูุซู ุงูู Response ูู ุงูุญุงูุชูู
3. ุงูุชุจ ุงูู Impact: "ุชูููุง ูู ุงููุตูู ูุตูุงุญูุงุช ุงูุฃุฏูู
   ุนู ุทุฑูู ุชุบููุฑ ูููุฉ Parameter ูู ุงูู Cookie/URL"
```

---

##  ููุฎุต ุงูุฌุฒุก ุงูุฑุงุจุน

| ุงูููููู | ุงูุดุฑุญ | ูุณุชูู ุงูุฎุทูุฑุฉ |
|---------|-------|---------------|
| **Arithmetic CAPTCHA** | ุจุชุณุฃู ูุณุฃูุฉ ุญุณุงุจูุฉ - ุณูู ุฌุฏุงู ุฃู ุณูุฑูุจุช ูุญููุง | ๐ด ุถุนูู |
| **Text-based CAPTCHA** | ุญุฑูู ูุดููุฉ - OCR ุจููุฑุฃูุง ุฏูููุชู | ๐ ุงูู ูู ุงููุชูุณุท |
| **Image-based CAPTCHA** | ุงุฎุชูุงุฑ ุตูุฑ - AI ุจูุชุนุฑู ุนูููุง | ๐ก ูุชูุณุท |
| **reCAPTCHA v2** | "ุฃูุง ูุด ุฑูุจูุช" + ุชุญููู ุณููู | ๐ข ููู |
| **reCAPTCHA v3** | ุชุญููู ุณููู ุฎูู ุจุงููุงูู | ๐ข ููู ุฌุฏุงู |
| **Unprotected Endpoints** | ุตูุญุงุช ููุชูุญุฉ ููุฌููุน | ๐ด ุฎุทูุฑุชูุง ุนูู ุญุณุจ ุงููุญุชูู |
| **Default Credentials** | ุจูุงูุงุช ุงุนุชูุงุฏ ุงูุชุฑุงุถูุฉ | ๐ด Critical |
| **Parameter Manipulation** | ุชุบููุฑ ููู ูู ุงูู Request | ๐ด ุนูู ุญุณุจ ุจุฑุถู ูููุตูู ูุฅูู |

> **๐ ุงูุฌุฒุก ุงูุฌุงู:** ููุชููู ุนู ุงูู Session Management ูุงูู Session IDs ูุงูู Cookies ุจูู ุชูุงุตูููุง 
