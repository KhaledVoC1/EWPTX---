# ๐ ุงูุฌูุณุฉ 6: Cookie Parameters ุชูููุฉ + Cookie Reverse Engineering & Tampering
## Slides 78 โ 92

---

## ๐ Slide 78: ูุนุงูู Expiration / Max-Age
### Cookie Parameters: Expiration/Max-Age

ูู ุงูุฌูุณุฉ ุงููู ูุงุชุช ุงุชููููุง ุนู HttpOnly ู Secure ู SameSite. ุฏูููุชู ูููู ุขุฎุฑ Parameter ููู: **ูุฏุฉ ุญูุงุฉ ุงูู Cookie**! โฐ

### ุงูุชุนุฑูู:
> ูุนุงูู **Expiration/Max-Age** ุจูุชุญูู ูู **ุนูุฑ ุงูู Cookie** - ูุนูู ูุฏ ุฅูู ูุชูุถู ููุฌูุฏุฉ ูุจู ูุง ุชุชูุณุญ.

### ุงููุฑู ุจูู ุงูุงุชููู:

| ุงููุนุงูู | ุงูุดุฑุญ | ุงููุซุงู |
|---------|-------|--------|
| **Expires** | ุชุงุฑูุฎ ูููุช ูุญุฏุฏ ุงูู Cookie ุชูุชูู ููู | `Expires=Thu, 31 Dec 2026 23:59:59 GMT` |
| **Max-Age** | ุนุฏุฏ ุงูุซูุงูู ูู ุฏูููุชู ูุญุฏ ูุง ุชูุชูู | `Max-Age=3600` (ุณุงุนุฉ ูุงุญุฏุฉ) |

### ุฃููุงุน ุงูู Cookies ุญุณุจ ุงูุนูุฑ:

#### 1๏ธโฃ Session Cookies (ูุคูุชุฉ)
```http
Set-Cookie: session_id=abc123; HttpOnly; Secure
# ูููุด Expires ููุง Max-Age โ ุจุชุชูุณุญ ููุง ุชููู ุงููุชุตูุญ!
```
- ุจุชุชูุณุญ ููุง ุงููุณุชุฎุฏู **ูููู ุงููุชุตูุญ** (ูุด ุงูุชุงุจ - ุงููุชุตูุญ ููู!)
- ููููุงุด `Expires` ููุง `Max-Age`
- ุฏู ุงูุฃูุซุฑ ุฃูุงูุงู ููู Session Management

#### 2๏ธโฃ Persistent Cookies (ุฏุงุฆูุฉ)
```http
Set-Cookie: remember_me=xyz789; Max-Age=2592000; HttpOnly; Secure
# 2592000 ุซุงููุฉ = 30 ููู โ ุงูู Cookie ูุชูุถู ููุฌูุฏุฉ 30 ููู!
```
- ุจุชูุถู ููุฌูุฏุฉ **ุญุชู ุจุนุฏ ูุง ุชููู ุงููุชุตูุญ**
- ูููุง `Expires` ุฃู `Max-Age`
- ุจุชูุณุชุฎุฏู ูู ููุฒุฉ **"Remember Me"**

### ููู ุฏู ููู ูู ุงูุฃูุงูุ

> **ูู ูุง ุนูุฑ ุงูู Cookie ูุงู ุฃุทููุ ูู ูุง ูุงูุฐุฉ ุงููุฌูู ูุงูุช ุฃูุจุฑ!** โณ

ุชุฎูู ูุฏู:
```
Cookie ุนูุฑูุง ุณุงุนุฉ ูุงุญุฏุฉ:
ุงูููุงุฌู ูุงุฒู ูุณุฑููุง ููุณุชุฎุฏููุง ูู ุฎูุงู 60 ุฏูููุฉ

Cookie ุนูุฑูุง 30 ููู:
ุงูููุงุฌู ุนูุฏู ุดูุฑ ูุงูู ูุณุชุฎุฏููุง ุจุฑุงุญุชู! ๐

Cookie ููููุงุด Expiration:
ูููุด ูุฏุฉ ูุญุฏุฏุฉ โ ูููู ุชูุถู ุตุงูุญุฉ ูุฃุณุงุจูุน ุฃู ุดููุฑ!
```

> **๐ด ูู ูุงูุน ุงูู Pentesting:** ูููุช ุชุทุจูู ุจููู ูุงู ุจูุญุท Session Cookie ุจู `Max-Age=31536000` (ุณูุฉ ูุงููุฉ!). ูุนูู ูู ุญุฏ ุณุฑู ุงูู Cookie ุจุชุงุนุชูุ ููุฏุฑ ููุถู ูุณุชุฎุฏููุง ุณูุฉ ูุงููุฉ! ุฏู Finding ุจุชุตููู **High** ูู ุฃู Pentest Report.
>
> **ุงูุชูุตูุฉ:** ุงูู Session Cookies ุงูููุฑูุถ ุชููู ุนูุฑูุง **ูุตูุฑ** (30 ุฏูููุฉ ูุญุฏ ุณุงุนุฉ ููุชุทุจููุงุช ุงูุญุณุงุณุฉ ุฒู ุงูุจููู)ุ ู**ุชุชุฌุฏุฏ** ุจุนุฏ ุฃู ุนูููุฉ ูููุฉ.

---

## ๐ Slide 79-80: ุฃูุซูุฉ ุนูููุฉ
### Examples: Setting a Secure Session Cookie

ุงูุณูุงูุฏ ุฏู ุจุชุฏูู **ุงููุซุงู ุงููุงูู** ูู Request ู Response ุจููุถุญ ูู ุงูู Cookie Parameters ูุน ุจุนุถ:

### ุงูู Request (ุงููุณุชุฎุฏู ุจูุณุฌู ุฏุฎูู):
```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded

username=testuser&password=examplepassword
```

### ุงูู Response (ุงูุณูุฑูุฑ ุจูุฑุฏ ุจุงูู Session Cookie):
```http
HTTP/1.1 200 OK
Set-Cookie: session_id=abc123xyz; HttpOnly; Secure; SameSite=Lax; Path=/; Max-Age=3600
Content-Type: text/html

<html>
<body>Welcome, testuser!</body>
</html>
```

### ุชุญููู ุงูู Cookie:
```
session_id=abc123xyz     โ ุงุณู ุงูู Cookie ููููุชูุง (ุงูู Session ID)
HttpOnly                 โ JavaScript ูุด ููุฏุฑ ููุฑุฃูุง (ุญูุงูุฉ ูู XSS)
Secure                   โ ุจุชุชุจุนุช ุนูู HTTPS ุจุณ (ุญูุงูุฉ ูู MitM)
SameSite=Lax             โ ูุด ุจุชุชุจุนุช ูุน Cross-Site POST (ุญูุงูุฉ ูู CSRF)
Path=/                   โ ุงูู Cookie ุตุงูุญุฉ ููู ุตูุญุงุช ุงููููุน
Max-Age=3600             โ ุจุชูุชูู ุจุนุฏ ุณุงุนุฉ (3600 ุซุงููุฉ)
```

### ๐ฏ ุงูู Checklist ุงููุงููุฉ ููุญุต Cookie ูุงุญุฏุฉ:

```
ุนูุตุฑ ุงููุญุต                    ุงูุญุงูุฉ ุงููุซุงููุฉ         ูู ูุด ููุฌูุฏ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
HttpOnly                       โ ููุฌูุฏ                โ XSS Risk
Secure                         โ ููุฌูุฏ                โ MitM Risk
SameSite                       โ Lax ุฃู Strict         โ CSRF Risk
Path                           โ / ุฃู ูุณุงุฑ ูุญุฏุฏ        โ Scope Issue
Max-Age/Expires                โ ูุตูุฑ (โค3600)          โ Long-lived Session
ุงูู Value (Session ID)          โ ุทููู ูุนุดูุงุฆู          โ Predictable Session
```

> **๐ก Pro Tip:** ูู Burp Suiteุ ููุง ุชุนุชุฑุถ ุฃูู Response ุจุนุฏ ุงูู Loginุ ุฏูุฑ ุนูู `Set-Cookie` header ูุงุนูู ุงูู Checklist ุฏู. ูู ุฃูู ูู 30 ุซุงููุฉ ูููู ุชุทูุน 3-5 Findings!

---

## ๐ Slide 81: ุนููุงู ุงููุณู
### Testing Session Management Schema: Cookie Tampering

ุฎูุตูุง ุงูุฌุฒุก ุงููุธุฑู ุนู ุงูู Cookies. ุฏูููุชู ูุฏุฎู ูู ุงูุฌุฒุก **ุงูุนููู ุงููุฌููู**.

---

## ๐ Slide 82: ุชุนุฑูู ุงุฎุชุจุงุฑ ูุฎุทุท ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช
### Testing Session Management Schema (WSTG-SESS-01)

### ุงูุชุนุฑูู:
> ุงุฎุชุจุงุฑ **"ูุฎุทุท ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช"** ูู ุฏููู OWASP WSTG ุจูุฑูุฒ ุนูู **ุชูููู ุฃูุงู ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช** ูู ุชุทุจููุงุช ุงูููุจ. ุจูุชุฃูุฏ ุฅู ุขููุงุช ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช **ูุชููุฐุฉ ุจุดูู ุตุญูุญ** ูููููุงุด ุซุบุฑุงุช ููุฏุฑ ุงูููุงุฌู ูุณุชุบููุง ุนุดุงู ูุณุฑู ุฃู ูุชูุงุนุจ ูู ุงูุฌูุณุงุช.

### ุงููุฏู ุงูุฑุฆูุณู:
> ุงูุชุญูู ูู **ุชุตููู ูููุฉ** ูุฎุทุท ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช - ุจูุนูู ุฅุฒุงู ุงูุชุทุจูู ุจูุนูู Session IDs ูCookies ูุจูุฏูุฑูู ูุจูููููู. ุจููุญุต ุจุงูุชุญุฏูุฏ ุนูููุงุช **ุงูุฅูุดุงุก (Creation)** ู**ุงูุตูุงูุฉ (Maintenance)** ู**ุงูุฅููุงุก (Termination)**.

### ุจุงููุตุฑู ูุฏู:
ุจููุนุจ ุฏูุฑ **ููุชุด ุฌูุฏุฉ** ๐ต๏ธ ููู Session Management. ุจูุดูู ูู ูู ุญุงุฌุฉ ุดุบุงูุฉ ุจุฃูุงู ููุง ููู ุซุบุฑุงุช ูููู ุญุฏ ูุณุชุบููุง.

> **๐ด ูู ูุงูุน ุงูู Pentesting:** ุงูุงุฎุชุจุงุฑ ุฏู ูู ุฃูุชุฑ ุงูุงุฎุชุจุงุฑุงุช ุงููู ุจุชุทูุน Findings! ูุฃู ูุชูุฑ ูู ุงููุจุฑูุฌูู ุจูุนุชูุฏูุง ุนูู ุงูู Framework ุงูุงูุชุฑุงุถู ูู ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุจุฏูู ูุง ูุธุจุทูุง ุงูุฅุนุฏุงุฏุงุช. ูุฏู ุจููุชุฌ ุนูู Cookies ุจุฏูู Flags ุฃูููุฉ ู Session IDs ุถุนููุฉ.

---

## ๐ Slide 83: ุฎุทูุงุช ุงููุฌูู ููููุฌูุฉ ุงูุงุฎุชุจุงุฑ
### Testing Session Management Schema - Attack Pattern

### ุงููููุฌูุฉ ุงูููุชุจุนุฉ (3 ุฎุทูุงุช):

### ุงูุฎุทูุฉ 1: ุฌูุน ุงูู Cookies ๐งบ
```
1. ุณุฌู ุฏุฎูู ุจุญุณุงุจุงุช ูุฎุชููุฉ
2. ุงุฌูุน ุงูู Session Cookies ูู ูู ุญุณุงุจ
3. ุณุฌู ูู Cookie ูุน ุงูุชูููุช ูุงูุญุณุงุจ ุงููุณุชุฎุฏู

ูุซุงู:
User 1 โ session_id=YWRtaW46MTY5OTkwMDAwMQ==
User 2 โ session_id=dXNlcjI6MTY5OTkwMDAwMg==
User 3 โ session_id=dXNlcjM6MTY5OTkwMDAwMw==
```

### ุงูุฎุทูุฉ 2: ุชุญููู ุนูุณู ููู Cookies (Reverse Engineering) ๐
```
ุจูุญูู ุงูู Cookies ุนุดุงู ูููู ุฅุฒุงู ุจุชุชุนูู (ุจุชุชููุฏ):

ุงูู Cookie: YWRtaW46MTY5OTkwMDAwMQ==
โ (Base64 Decode)
admin:1699900001

ุงูู Cookie: dXNlcjI6MTY5OTkwMDAwMg==
โ (Base64 Decode)
user2:1699900002

ุงูุชุดููุง ุงูููุท! ๐ฏ
session_id = Base64(username:timestamp)
```

### ุงูุฎุทูุฉ 3: ุชุฒููุฑ ุงูู Cookie (Manipulation/Forgery) ๐จ
```
ุฏูููุชู ููุฏุฑ ูุนูู Cookie ูุฒูุฑุฉ ูุฃู ููุฒุฑ:

ุนุงูุฒูู ูุฏุฎู ุญุณุงุจ ุงูุฃุฏููุ
1. ูุนูู: admin:1699900005 (timestamp ุญุงูู)
2. ูุดูุฑู Base64: YWRtaW46MTY5OTkwMDAwNQ==
3. ูุญุท ุงููููุฉ ูู Cookie:
   Cookie: session_id=YWRtaW46MTY5OTkwMDAwNQ==
4. ูุจุนุช Request โ ููุงูู ููุณูุง ูุณุฌููู ุฏุฎูู ูุฃุฏูู! ๐
```

### ุฃูุฏุงู ุงูุงุฎุชุจุงุฑ (Test Objectives):
1. **ุงุฌูุน Session Tokens** ูููุณ ุงููุณุชุฎุฏู ููุณุชุฎุฏููู ูุฎุชูููู
2. **ุญูู ุงูุนุดูุงุฆูุฉ** - ูู ููู Randomness ูุงูู ูููุน ุงูุชุฎูููุ
3. **ุนุฏูู Cookies** ุงููู ูุด Signed ูุงููู ูููุง ูุนูููุงุช ูููู ุชุชุบูุฑ

> **๐ก ุฃุฏุงุฉ ูููุฉ:** ุงุณุชุฎุฏู **Burp Suite โ Sequencer** ูุชุญููู ุนุดูุงุฆูุฉ ุงูู Session IDs. ุงูุฃุฏุงุฉ ุฏู ุจุชุฌูุน ุขูุงู ุงูู Session IDs ูุจุชุญูู ุงูููุท ุงูุฅุญุตุงุฆู ุจุชุงุนูู ุนุดุงู ุชุญุฏุฏ ูู ูููู Patterns ูููู ุชุชุชููุน.

---

## ๐ Slide 84: ุฃูุฏุงู ุงูุงุฎุชุจุงุฑ - ุชุญุฏูุฏ ุงูุถุนู ูู ุจููุฉ ุงูู Token
### Identify Weaknesses in Session Token Structure

### ุงููุฏู 1: ุชุญุฏูุฏ ุซุบุฑุงุช ูู ุจููุฉ ุงูู Session Token

**ุจูุณุฃู ููุณูุง:**
- ูู ุงูู Token **Predictable** (ูุงุจู ููุชููุน)ุ
- ูู ููู **Patterns** ูุงุถุญุฉ ูููู ูุณุชุบููุงุ
- ูู ุทุฑููุฉ **ุงูุชุดููุฑ/ุงูู Encoding** ูููุฉ ููุงูุฉ ุถุฏ ุงูู Reverse Engineeringุ

**ุชุฌุงุฑุจ ุนูููุฉ:**
```
# ูุณุฌู ุฏุฎูู 5 ูุฑุงุช ูููุงุฑู ุงูู Session IDs:
Login 1: SESS=f7a8b2c1d3e4
Login 2: SESS=f7a8b2c1d3e5   โ ูุฑู ุฑูู ูุงุญุฏ ุจุณ!
Login 3: SESS=f7a8b2c1d3e6   โ Sequential (ูุชุชุงุจุน)!
Login 4: SESS=f7a8b2c1d3e7   โ ูุฏู ุงูู ID Predictable!
Login 5: SESS=f7a8b2c1d3e8

# ุงูููุฑูุถ ุชููู ูุฏู (Random ุชูุงูุงู):
Login 1: SESS=a7f329d4e8b1c5
Login 2: SESS=k2m8p4x9r1w6j3
Login 3: SESS=q5t7v2y4a8d0g6
# ูููุด ุฃู ุนูุงูุฉ ุจูู ุงูู IDs โ Secure!
```

### ุงููุฏู 2: ุถูุงู ุงูุชุนุงูู ุงูุขูู ูุน ุงูุฌูุณุงุช

- ูู ุงูู Session ID **ุจูุชุฌุฏุฏ ุจุนุฏ Login** (Session Regeneration)ุ
- ูู ุงูู Session **ุจุชุชุฏูุฑ ูุนูุงู ุจุนุฏ Logout**ุ
- ูู ููู ุญูุงูุฉ ุถุฏ **Session Fixation**ุ

```
# ุงุฎุชุจุงุฑ Session Regeneration:
ูุจู Login:  Cookie: PHPSESSID=old_session_123
ุจุนุฏ Login:  Cookie: PHPSESSID=new_session_456  โ ุตุญ! ุงุชุบูุฑ โ

# ูู ุงูู ID ูุบูุฑุด ุจุนุฏ Login:
ูุจู Login:  Cookie: PHPSESSID=same_session_789
ุจุนุฏ Login:  Cookie: PHPSESSID=same_session_789  โ ุฎุทุฑ! Session Fixation ูููู! โ
```

---

## ๐ Slide 85: ุฃูุฏุงู ุงูุงุฎุชุจุงุฑ - ุงูุชุญูู ูู ุงููุตูู ูุงูุตูุงุญูุงุช
### Test for Authorization Control Failures

### ุงููุฏู 3: ุงูุชุดุงู ูุดู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช

**ุงููุดููุฉ:** ุจุนุถ ุงูุชุทุจููุงุช ุจุชุฎุฒู ูุนูููุงุช ุญุณุงุณุฉ (ุฒู ุงูุตูุงุญูุงุช) **ุฌูู ุงูู Cookie ููุณูุง** ุจุฏู ูุง ุชุฎุฒููุง ุนูู ุงูุณูุฑูุฑ!

```http
# Cookie ุฎุทูุฑุฉ - ูููุง ูุนูููุงุช ุตูุงุญูุงุช:
Set-Cookie: user_data=role%3Dguest%26uid%3D101; Path=/

# ููุง ูุนูู URL Decode:
user_data = role=guest&uid=101

# ุงูููุงุฌู ุจูุบูุฑ:
user_data = role=admin&uid=1

# ูู ุงูุณูุฑูุฑ ุจูุซู ูู ููู ุงูู Cookie โ ุฏุฎููุง ูุฃุฏูู! ๐
```

**ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ:**
> **ุงูุณูุฑูุฑ ูุงุฒู ูุนูู Authorization Checks ุนูู ุงูู Server-Side** ููุด ูุนุชูุฏ ุนูู ุจูุงูุงุช ุงูู Cookie ููุชุญูู ูู ุงูุตูุงุญูุงุช. ุงูู Cookie ุงูููุฑูุถ ุชุญุชูู ุนูู Session ID ุจุณ - ูุงูุณูุฑูุฑ ูุฑุฌุน ููุงุนุฏุฉ ุงูุจูุงูุงุช ุนุดุงู ูุนุฑู ุตูุงุญูุงุช ุงููุณุชุฎุฏู.

### ุงููุฏู 4: ุชูููู ุขููุงุช ุงูุชูุงุก ูุฅุจุทุงู ุงูุฌูุณุงุช

- ูู ุงูุฌูุณุฉ ุจุชูุชูู ุจุนุฏ ูุชุฑุฉ **ุนุฏู ูุดุงุท** ูุนูููุฉุ
- ูู ุงูุฌูุณุฉ **ุจุชุชุจุทู ูุนูุงู** ุจุนุฏ ุงูู Logoutุ
- ูู ูุนุงููุงุช ุงูู Cookie (`Max-Age`, `Expires`, `HttpOnly`, `Secure`, `SameSite`) **ูุชุธุจุทุฉ ุตุญ**ุ

```
# ุงุฎุชุจุงุฑ Session Expiration:
1. ุณุฌู ุฏุฎูู โ ุฎุฏ ุงูู Session Cookie
2. ุงุณุชูู 30 ุฏูููุฉ (ุฃู ุฃูุชุฑ ุญุณุจ ุณูุงุณุฉ ุงููููุน)
3. ุงุณุชุฎุฏู ุงูู Cookie ุนุดุงู ุชุจุนุช Request
4. ูู ุงูุฑุฏ "401 Unauthorized" โ ุงูุฌูุณุฉ ุงูุชูุช โ
5. ูู ุงูุฑุฏ "200 OK" โ ุงูุฌูุณุฉ ูุณู ุดุบุงูุฉ โ (Finding!)

# ุงุฎุชุจุงุฑ Logout:
1. ุณุฌู ุฏุฎูู โ ุฎุฏ ุงูู Session Cookie โ ุงุญูุธูุง
2. ุงุนูู Logout
3. ุงุณุชุฎุฏู ุงูู Cookie ุงููุฏููุฉ ุชุงูู
4. ูู ุงูุฑุฏ "401 Unauthorized" โ ุงูู Logout ุดุบุงู ุตุญ โ
5. ูู ุงูุฑุฏ "200 OK" โ ุงูู Server ูุณุญุด ุงูู Session! โ (Finding!)
```

---

## ๐ Slide 86: ุงูุชุญูู ูู ุฃูุงู ููู ุงูู Cookies
### Verify Secure Cookie Transmission

### ุงููุฏู 5: ุงูุชุฃูุฏ ูู ููู ุงูู Cookies ุจุดูู ุขูู

ุจูุชุฃูุฏ ูู ุญุงุฌุชูู ุฃุณุงุณูุชูู:

**1. ุงูู Secure Attribute:**
```http
# ุตุญ โ - ุงูู Cookie ุจุชุชุจุนุช ุนูู HTTPS ุจุณ
Set-Cookie: session_id=abc; Secure

# ุบูุท โ - ูููู ุชุชุจุนุช ุนูู HTTP (ุบูุฑ ูุดูุฑ)
Set-Cookie: session_id=abc
# (ูููุด Secure flag!)
```

**2. ุงูู HttpOnly Attribute:**
```http
# ุตุญ โ - JavaScript ูุด ููุฏุฑ ููุฑุฃูุง
Set-Cookie: session_id=abc; HttpOnly

# ุบูุท โ - JavaScript ููุฏุฑ ููุฑุฃูุง ููุณุฑููุง
Set-Cookie: session_id=abc
# (ูููุด HttpOnly flag!)
```

---

## ๐ Slide 87-88: ุฌุฏูู ุงูุงุฎุชุจุงุฑุงุช ูุงูุซุบุฑุงุช
### Key Tests/Techniques & Vulnerabilities

### ุงูุฌุฏูู ุงูุดุงูู:

| ุงูุงุฎุชุจุงุฑ | ุงููุตู | ุงูุซุบุฑุฉ ูู ูุดู |
|----------|-------|---------------|
| **Predictable Session IDs** | ุชุญููู ุนุดูุงุฆูุฉ ุงูู Tokens | ุงูููุงุฌู ููุฏุฑ ูุฎููู Session IDs ุตุงูุญุฉ |
| **Session Fixation** | ูู ุงูููุงุฌู ููุฏุฑ ูุซุจุช Session IDุ | ุงูููุงุฌู ูุชุญูู ูู ุงูุฌูุณุฉ ุจุนุฏ ุงูู Login |
| **Session Expiration** | ูู ุงูุฌูุณุฉ ุจุชูุชูู ุจุนุฏ Timeout ู Logoutุ | ุฌูุณุงุช ูุชููุชุด ูููู ูุณุชุฎุฏููุง ุงูููุงุฌู |
| **Session Hijacking** | ุฅุนุงุฏุฉ ุชุดุบูู Cookies ูู ุฃุฌูุฒุฉ ูุฎุชููุฉ | ุณุฑูุฉ ุงูุฌูุณุฉ ูู ุงูู Token ูุด ูุฑุจูุท ุจุงูุฌูุงุฒ |
| **Cookie Security Flags** | ูุญุต HttpOnly, Secure, SameSite | ุจุฏูู ุงูู Flags: XSS, CSRF, MitM ูููู ูููููู |
| **Session Timeout** | ุงุฎุชุจุงุฑ ุงูุชูุงุก ุงูุฌูุณุฉ ุจุนุฏ ูุชุฑุฉ ุฎููู | ุฌูุณุงุช ุทูููุฉ = ูุฑุตุฉ ุฃูุจุฑ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู |
| **Token in URLs** | ูู ุงูู Token ุธุงูุฑ ูู ุงูู URLุ | ุชุณุฑูุจ ุนุจุฑ Referer, Logs, Browser History |

> **๐ก ูุตูุญุฉ:** ุงูุฌุฏูู ุฏู **Checklist** ููุชุงุฒุฉ! ุงุทุจุนู ูุงุณุชุฎุฏูู ูู ูู Pentest. ูู ุตู = ุงุฎุชุจุงุฑ ูุงุฒู ุชุนููู!

---

## ๐ Slide 89: Cookie Reverse Engineering & Tampering - ุงูููุฏูุฉ
### Cookie Reverse Engineering & Tampering

### ุงูุชุนุฑูู:
> **Cookie Reverse Engineering & Manipulation** ูุนูู ุชุญููู ูุชุนุฏูู ุงูู Session Cookies ุนุดุงู ููุงูู ุซุบุฑุงุช ูู ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช. ุงููุฏู ุฅููุง ูููู ุฅุฒุงู ุงูู Cookies **ูุจููุฉ ููุดูุฑุฉ ููุญููุฉ**ุ ููู ุงูุชูุงุนุจ ูููุง ูููู **ูุชุฎุทู ุนูุงุตุฑ ุงูุชุญูู ุงูุฃูููุฉ** ุฃู ูุฏููุง ูุตูู ุบูุฑ ูุตุฑุญ.

### ูุนูู ุจุงููุตุฑู:
ุจููุนุจ ุฏูุฑ **ุงููุญูู ุงูุฌูุงุฆู** ๐ต๏ธ - ุจูุงุฎุฏ ุงูู Cookie ููุญุท ุนูููุง ุชุญุช ุงููุฌูุฑ ููููู ุฅุฒุงู ุงุชุนููุชุ ูุจุนุฏูู ูุฌุฑุจ **ูุนุฏู ูููุง** ููุดูู ูู ุงูุชุทุจูู ุจููุจู ุงูุชุนุฏูู ููุง ูุฃ.

---

## ๐ Slide 90: ุงูู Reverse Engineering ุจุงูุชูุตูู
### Cookie Structure & Encoding (Reverse Engineering)

### ุฅูู ุงููู ุจูุนููู ุจุงูุธุจุทุ

**ุงูุฎุทูุฉ 1: ุงููุธุฑ ูู ุงูู Cookie ูุชุญููู ุจููุชูุง**
```
Cookie: user_session=dXNlcj1haG1lZDtyb2xlPWFkbWluO2V4cD0xNjk5OTAwMDAw
```

**ุงูุฎุทูุฉ 2: ุชุญุฏูุฏ ููุน ุงูู Encoding**
```
ุงููููุฉ ุชูุชูู ุจู == ุฃู ุจุชุญุชูู ุนูู a-z, A-Z, 0-9, +, / โ ุบุงูุจุงู Base64

ุจูุฌุฑุจ Base64 Decode:
echo "dXNlcj1haG1lZDtyb2xlPWFkbWluO2V4cD0xNjk5OTAwMDAw" | base64 -d
# ุงููุชูุฌุฉ: user=ahmed;role=admin;exp=1699900000
```

**ุงูุฎุทูุฉ 3: ููู ุงููุญุชูู**
```
user=ahmed        โ ุงุณู ุงููุณุชุฎุฏู
role=admin        โ ุงูุตูุงุญูุฉ (ุฏู ุงููู ูููุนุจ ููู!)
exp=1699900000    โ ุชุงุฑูุฎ ุงูุงูุชูุงุก (Unix Timestamp)
```

### ุฃููุงุน ุงูู Encoding ุงูุดุงุฆุนุฉ:

| ุงูููุน | ุงูุดูู | ุฅุฒุงู ุชุนุฑูู |
|-------|-------|-----------|
| **Base64** | `YWRtaW4=` | ุญุฑูู + ุฃุฑูุงู + `=` ูู ุงูุขุฎุฑ |
| **URL Encoding** | `role%3Dadmin` | ูููุง `%XX` |
| **Hex** | `61646d696e` | ุฃุฑูุงู ูุญุฑูู a-f ุจุณ |
| **JSON + Base64** | `eyJ1c2VyIjoiYW...` | ุจุชุจุฏุฃ ุจู `eyJ` (ุฏู JWT!) |
| **Hashed** | `5f4dcc3b5aa765d61d83...` | ุทูู ุซุงุจุชุ ุนุดูุงุฆูุฉ ุนุงููุฉ |

> **โ๏ธ ููู ุฌุฏุงู:** ุงูู **Encoding โ Encryption**!
> - **Encoding** (ุฒู Base64) = ุฃู ุญุฏ ููุฏุฑ ูููู! ูููููุด ููุชุงุญ!
> - **Encryption** (ุฒู AES) = ูุญุชุงุฌ ููุชุงุญ ุณุฑู ุนุดุงู ุชููู
> 
> ูุชูุฑ ูู ุงููุจุฑูุฌูู ุจููุชูุฑูุง ุฅู Base64 "ุชุดููุฑ" ูุฏู ุบูุท ูุจูุฑ! ๐ค

---

## ๐ Slide 91: Cookie Manipulation/Tampering ุจุงูุชูุตูู
### Cookie Manipulation/Tampering

### ุซูุงุซ ุณููุงุฑูููุงุช ุฑุฆูุณูุฉ:

### 1๏ธโฃ ุชุบููุฑ ุงูุตูุงุญูุงุช (Role Tampering)
```
# ุงูู Cookie ุงูุฃุตููุฉ:
Cookie: user_data=role=guest;uid=101

# ุจุนุฏ ุงูุชูุงุนุจ:
Cookie: user_data=role=admin;uid=101
# โ ุบูุฑูุง guest ูู admin

# ูู ูุดูุฑุฉ ุจู Base64:
# ุงูุฃุตููุฉ:
Cookie: data=cm9sZT1ndWVzdDt1aWQ9MTAx
# ุจุนุฏ ุงูุชูุงุนุจ:
# 1. ูุนูู ุงูู Value ุงูุฌุฏูุฏุฉ: role=admin;uid=101
# 2. ูุดูุฑูุง Base64: cm9sZT1hZG1pbjt1aWQ9MTAx
# 3. ูุญุทูุง:
Cookie: data=cm9sZT1hZG1pbjt1aWQ9MTAx
```

### 2๏ธโฃ ุชุบููุฑ ูููุฉ ุงููุณุชุฎุฏู (User ID Manipulation)
```
# ุงูู Cookie ุงูุฃุตููุฉ:
Cookie: session=user_id=42

# ุจุนุฏ ุงูุชูุงุนุจ:
Cookie: session=user_id=1
# โ ุบูุฑูุง ูู user_id=1 (ุนุงุฏุฉู ุงูุฃุฏูู!)

# ูุฏู ูู ุงูุณูุฑูุฑ ูุด ุจูุชุญูู โ ููุดูู ุจูุงูุงุช ุงูุฃุฏูู!
```

### 3๏ธโฃ ุณุฑูุฉ ุงูุฌูุณุฉ (Session Hijacking)
```
# ูู ุงูู Session Token ุซุงุจุช ุฃู ูุงุจู ููุชููุน:
Login 1 (10:00): session=token_20241110_001
Login 2 (10:01): session=token_20241110_002
Login 3 (10:02): session=token_20241110_003

# ุงูููุงุฌู ููุฏุฑ ูุชููุน:
# Session ุงูุชุงููุฉ: session=token_20241110_004
# ุจูุญุทูุง ูู ูุชุตูุญู โ ุจูุฏุฎู ุญุณุงุจ ุงูุดุฎุต ุงูุชุงูู! ๐
```

### ุงูุฃุฏูุงุช ุงููุณุชุฎุฏูุฉ ูู ุงูู Cookie Tampering:

```
๐ ุงูุฃุฏูุงุช ุงูุฃุณุงุณูุฉ:

1. Burp Suite (Proxy โ Intercept โ Edit Cookie)
   ุฃููู ุฃุฏุงุฉ - ุจุชุนุชุฑุถ ุงูู Request ูุชุนุฏู ุงูู Cookie ูุจู ูุง ุชูุตู ููุณูุฑูุฑ

2. Browser DevTools (F12 โ Application โ Cookies)
   ุจุชูุฏุฑ ุชุนุฏู ุฃู Cookie ูุจุงุดุฑุฉ ูู ุงููุชุตูุญ

3. Cookie Editor Extension (Chrome/Firefox)
   ุฅุถุงูุฉ ูููุชุตูุญ ุจุชุณูู ุชุนุฏูู ุงูู Cookies

4. CyberChef (gchq.github.io/CyberChef)
   ุฃุฏุงุฉ ููุจ ููู ูุชุดููุฑ ุฃู ููุน Encoding (Base64, Hex, URL, etc.)

5. Hashcat / John the Ripper
   ูู ุงูู Cookie ูุดูุฑุฉ ุจู Hash โ ุจูุญุงูู ููุณุฑู
```

---

## ๐ Slide 92: Lab Demo - Cookie Tampering
### ๐งช Lab Demo: Testing Session Management Schema: Cookie Tampering

### ุฎุทูุงุช ุงูู Lab ุงูุชูุตูููุฉ:

#### Phase 1: ุงูุงุณุชุทูุงุน ูุฌูุน ุงูู Cookies
```
1. ุดุบูู Burp Suite ูุงุนูู Intercept ุนูู ุงูู Traffic
2. ุณุฌู ุฏุฎูู ุจุญุณุงุจ ุนุงุฏู (user)
3. ุดูู ุงูู Set-Cookie ูู ุงูู Response
4. ุณุฌู ุฎุฑูุฌ ูุณุฌู ุฏุฎูู ุจุญุณุงุจ ุชุงูู
5. ูุงุฑู ุงูู Cookies:
   User 1: session=YWhtZWQ6dXNlcjoxNjk5OTAw
   User 2: session=c2FyYTp1c2VyOjE2OTk5MDE=
```

#### Phase 2: ุงูู Reverse Engineering
```
1. ุฎุฏ ุงูู Cookie Value ุงูุฃููู
2. ุฌุฑุจ Base64 Decode:
   YWhtZWQ6dXNlcjoxNjk5OTAw โ ahmed:user:1699900
   c2FyYTp1c2VyOjE2OTk5MDE= โ sara:user:1699901

3. ุงูููุท ูุงุถุญ! ๐ฏ
   Format: username:role:timestamp
```

#### Phase 3: ุงูุชุฒููุฑ
```
1. ุงุนูู Cookie ุฌุฏูุฏุฉ:
   admin:admin:1699902

2. ุดูุฑูุง Base64:
   YWRtaW46YWRtaW46MTY5OTkwMg==

3. ูู Burp Repeater ุฃู DevTools:
   ุบูุฑ ูููุฉ ุงูู Cookie ูููููุฉ ุงูุฌุฏูุฏุฉ

4. ุงุจุนุช Request ูุตูุญุฉ ุงูุฃุฏูู

5. ูู ุฏุฎูุช โ Critical Finding! ๐
```

#### Phase 4: ุงูุชูุซูู ููุชูุฑูุฑ
```
Finding: Insecure Session Token Generation
Severity: Critical (CVSS 9.1)
Description: Session tokens are generated using a predictable pattern
             (Base64-encoded username:role:timestamp) allowing attackers
             to forge valid session tokens for any user.
Impact: Complete account takeover of any user including administrators.
Recommendation:
  1. Use cryptographically secure random session IDs
  2. Never embed user data in session tokens
  3. Implement server-side session validation
  4. Sign cookies with HMAC to prevent tampering
```

---

## ๐ฏ ููุฎุต ุงูุฌูุณุฉ ุงูุณุงุฏุณุฉ

| ุงูููููู | ุงูุดุฑุญ | ุฎุทูุฑุชู |
|---------|-------|--------|
| **Expiration/Max-Age** | ูุฏุฉ ุญูุงุฉ ุงูู Cookie | ุฌูุณุงุช ุทูููุฉ = ุฎุทุฑ ุฃูุจุฑ |
| **Session vs Persistent Cookie** | ูุคูุชุฉ vs ุฏุงุฆูุฉ | Persistent = ูุฑุตุฉ ุณุฑูุฉ ุฃูุจุฑ |
| **WSTG-SESS-01** | ุงุฎุชุจุงุฑ ูุฎุทุท ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช | ุงูู Framework ุงููุงูู ููุงุฎุชุจุงุฑ |
| **Cookie Reverse Engineering** | ูู ุชุดููุฑ ุงูู Cookie ูููู ุจููุชูุง | ุฃูู ุฎุทูุฉ ูู ุงููุฌูู |
| **Cookie Tampering** | ุชุบููุฑ ููู ุงูู Cookie | Privilege Escalation & Account Takeover |
| **Predictable Session IDs** | Session IDs ูุงุจูุฉ ููุชููุน | Session Hijacking |

> **๐ ุงูุฌูุณุฉ ุงูุฌุงูุฉ:** ููุฏุฎู ูู ุฃุฎุทุฑ ูุฌูุชูู ุนูู ุงูู Sessions: **Session Hijacking** (ุณุฑูุฉ ุงูุฌูุณุฉ) ู**Session Fixation** (ุชุซุจูุช ุงูุฌูุณุฉ) - ุจุงูุชูุตูู ุงูููู ูุน ุณููุงุฑูููุงุช ูุฌูู ูุงููุฉ! ๐ฅ
